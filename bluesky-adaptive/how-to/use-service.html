
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Running Your Agent as a Service with Bluesky Adaptive &#8212; bluesky-adaptive  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'how-to/use-service';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Extending Your Existing Python Tool for Use with Bluesky-Adaptive" href="extend-my-tool.html" />
    <link rel="prev" title="How-to Guides" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">bluesky-adaptive  documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../explanations/index.html">
    Explanations
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    How-to Guides
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutorials/index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://blueskyproject.io">
    Bluesky Project
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/bluesky/bluesky-adaptive" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/bluesky-adaptive" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-cube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://blueskyproject.io/mattermost/" title="Community" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-person-circle-question fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Community</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../explanations/index.html">
    Explanations
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    How-to Guides
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutorials/index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://blueskyproject.io">
    Bluesky Project
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/bluesky/bluesky-adaptive" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/bluesky-adaptive" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-cube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://blueskyproject.io/mattermost/" title="Community" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-person-circle-question fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Community</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">How-to Guides</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Running Your Agent as a Service with Bluesky Adaptive</a></li>
<li class="toctree-l1"><a class="reference internal" href="extend-my-tool.html">Extending Your Existing Python Tool for Use with Bluesky-Adaptive</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-agent-brains.html">Developing Agent/Recommender Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-agent-comms.html">Developing Communication Between an Asynchronous Agent and Experiment</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">How-to Guides</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Running Your Agent as a Service with Bluesky Adaptive</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="running-your-agent-as-a-service-with-bluesky-adaptive">
<h1>Running Your Agent as a Service with Bluesky Adaptive<a class="headerlink" href="#running-your-agent-as-a-service-with-bluesky-adaptive" title="Link to this heading">#</a></h1>
<p>Running your agent as a service in the Bluesky Adaptive ecosystem enables dynamic experimental control and decision-making in an asynchronous, distributed environment.
This document outlines how to configure and deploy your agent as a service, leveraging FastAPI for easy interaction and management.</p>
<section id="basic-agent-setup">
<h2>Basic Agent Setup<a class="headerlink" href="#basic-agent-setup" title="Link to this heading">#</a></h2>
<p>Start by defining your agent class and its operational parameters.
The following example demonstrates a basic agent setup, registering variables and defining startup and shutdown routines.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bluesky_adaptive.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">register_variable</span><span class="p">,</span> <span class="n">shutdown_decorator</span><span class="p">,</span> <span class="n">startup_decorator</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Agent</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_depth</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="mi">60</span>

<span class="n">aa</span> <span class="o">=</span> <span class="n">AA</span><span class="p">()</span>
<span class="n">bb</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">900</span><span class="p">}</span>
<span class="n">_v</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">_no_pv</span> <span class="o">=</span> <span class="mi">100</span>

<span class="k">def</span><span class="w"> </span><span class="nf">some_function</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Function is running: a = </span><span class="si">{</span><span class="n">a</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nd">@startup_decorator</span>
<span class="k">def</span><span class="w"> </span><span class="nf">startup1</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is startup function #1&quot;</span><span class="p">)</span>
    <span class="n">aa</span><span class="o">.</span><span class="n">_depth</span> <span class="o">=</span> <span class="mi">20</span>

<span class="nd">@shutdown_decorator</span>
<span class="k">def</span><span class="w"> </span><span class="nf">shutdown1</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is shutdown function #1&quot;</span><span class="p">)</span>

<span class="n">register_variable</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">aa</span><span class="p">,</span> <span class="s2">&quot;_depth&quot;</span><span class="p">,</span> <span class="n">pv_type</span><span class="o">=</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This agent can then be launched with with a uvicorn service by setting the <code class="docutils literal notranslate"><span class="pre">BS_AGENT_STARTUP_SCRIPT_PATH</span></code> environment variable to the path of the script and running the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">BS_AGENT_STARTUP_SCRIPT_PATH</span><span class="o">=</span>path/to/agent/script<span class="w"> </span>uvicorn<span class="w"> </span>bluesky_adaptive.server:app<span class="w"> </span>--reload
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">--reload</span></code> makes the server restart after code changes. Only use this option for development.</p>
</section>
<section id="advanced-agent-with-fastapi">
<h2>Advanced Agent with FastAPI<a class="headerlink" href="#advanced-agent-with-fastapi" title="Link to this heading">#</a></h2>
<p>For a more advanced setup involving the <code class="docutils literal notranslate"><span class="pre">bluesky_adaptive.agents</span></code> base classes, follow this pattern:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">class</span><span class="w"> </span><span class="nc">TestSequentialAgent</span><span class="p">(</span><span class="n">SequentialAgentBase</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pub_topic</span><span class="p">,</span> <span class="n">sub_topic</span><span class="p">,</span> <span class="n">kafka_bootstrap_servers</span><span class="p">,</span> <span class="n">kafka_producer_config</span><span class="p">,</span> <span class="n">tiled_profile</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Initialization code here</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">server_registrations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Register methods and properties as variables for FastAPI interaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_register_property</span><span class="p">(</span><span class="s2">&quot;queue_add_position&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_register_method</span><span class="p">(</span><span class="s2">&quot;generate_report&quot;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">server_registrations</span><span class="p">()</span>

    <span class="c1"># Example method to register</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;report&quot;</span><span class="p">}</span>

<span class="c1"># Example of starting and stopping the agent itself</span>
<span class="nd">@startup_decorator</span>
<span class="k">def</span><span class="w"> </span><span class="nf">startup_agent</span><span class="p">():</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="nd">@shutdown_decorator</span>
<span class="k">def</span><span class="w"> </span><span class="nf">shutdown_agent</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">agent</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

<span class="c1"># Agent instantiation and registration of variables for FastAPI</span>
<span class="n">agent</span> <span class="o">=</span> <span class="n">TestSequentialAgent</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">register_variable</span><span class="p">(</span><span class="s2">&quot;operating_mode&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">getter</span><span class="o">=</span><span class="n">agent</span><span class="o">.</span><span class="n">operating_mode_getter</span><span class="p">,</span> <span class="n">setter</span><span class="o">=</span><span class="n">agent</span><span class="o">.</span><span class="n">operating_mode_setter</span><span class="p">,</span> <span class="n">pv_type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we accomplished server registrations in the class definition:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">server_registrations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Register methods and properties as variables for FastAPI interaction</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_register_property</span><span class="p">(</span><span class="s2">&quot;queue_add_position&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_register_method</span><span class="p">(</span><span class="s2">&quot;generate_report&quot;</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">server_registrations</span><span class="p">()</span>
</pre></div>
</div>
<p>with additional customization in the startup script:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">register_variable</span><span class="p">(</span><span class="s2">&quot;operating_mode&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">getter</span><span class="o">=</span><span class="n">agent</span><span class="o">.</span><span class="n">operating_mode_getter</span><span class="p">,</span> <span class="n">setter</span><span class="o">=</span><span class="n">agent</span><span class="o">.</span><span class="n">operating_mode_setter</span><span class="p">,</span> <span class="n">pv_type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The startup and shutdown functions are then used to start and stop the agent Kafka consumer.</p>
<p>This can again be started using the</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">BS_AGENT_STARTUP_SCRIPT_PATH</span><span class="o">=</span>path/to/agent/script<span class="w"> </span>uvicorn<span class="w"> </span>bluesky_adaptive.server:app<span class="w"> </span>--reload
</pre></div>
</div>
</section>
<section id="running-your-agent-as-a-service">
<h2>Running Your Agent as a Service<a class="headerlink" href="#running-your-agent-as-a-service" title="Link to this heading">#</a></h2>
<p>Once your agent is configured, you can deploy it as a service, allowing for real-time control and adjustment of experimental parameters through HTTP requests. FastAPI facilitates this by providing a robust, easy-to-use platform for service deployment.</p>
<p>Utilize the <code class="docutils literal notranslate"><span class="pre">startup_decorator</span></code> and <code class="docutils literal notranslate"><span class="pre">shutdown_decorator</span></code> to manage the lifecycle of your service, ensuring that resources are appropriately allocated and released. Registering variables as shown allows for dynamic interaction with the agent’s operational parameters, enabling users to adjust experiment settings on the fly.</p>
<p>By following these guidelines, you can effectively run your agent as a service within the Bluesky Adaptive ecosystem, harnessing the power of asynchronous communication and distributed decision-making to enhance experimental workflows.</p>
</section>
<section id="exploring-the-api-through-a-web-browser">
<h2>Exploring the API through a web browser<a class="headerlink" href="#exploring-the-api-through-a-web-browser" title="Link to this heading">#</a></h2>
<p>By default, FastAPI generates an interactive API documentation using Swagger UI. You can access this documentation by navigating to the <code class="docutils literal notranslate"><span class="pre">/docs</span></code> endpoint of your FastAPI application.
If your application is running on the default host and port, the URL for the Swagger UI would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">8000</span><span class="o">/</span><span class="n">docs</span>
</pre></div>
</div>
<p>This URL might change if you configured the uvicorn launch script to run on a different host or port.
When you visit this URL in a web browser, you’ll see a user-friendly interface that lists all the routes, parameters, and bodies the API expects.
You can also try out the API directly from this interface by filling out the required fields and executing the requests.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">How-to Guides</p>
      </div>
    </a>
    <a class="right-next"
       href="extend-my-tool.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Extending Your Existing Python Tool for Use with Bluesky-Adaptive</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-agent-setup">Basic Agent Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-agent-with-fastapi">Advanced Agent with FastAPI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-your-agent-as-a-service">Running Your Agent as a Service</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-the-api-through-a-web-browser">Exploring the API through a web browser</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/bluesky/bluesky-adaptive/edit/main/docs/src/how-to/use-service.md">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/how-to/use-service.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2020, NSLS-II.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>