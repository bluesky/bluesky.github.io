

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Catalog Database &mdash; tiled 0.1.0b30.dev12+g4bd45b37 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=32ad838b"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs"></script>
      <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs"></script>
      <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
      <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
      <script type="module">
import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";
window.addEventListener("load", () => mermaid.run());
</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FAQ" href="faq.html" />
    <link rel="prev" title="Access Control" href="access-control.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            tiled
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/navigation.html">Navigate with the Python Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/slicing.html">Load Slices of Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/export.html">Deliberate Export</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/login.html">Log into an Authenticated Tiled Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/serving-files.html">Serve a Directory of Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/search.html">Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/writing.html">Writing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/simple-server.html">Simple Tiled Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/plotly-integration.html">Plot Data in Plotly Chart Studio</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How To Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../how-to/authentication.html">Python Client Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/profiles.html">Use Profiles to streamline Python client setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/client-logger.html">Use Performance and Debug Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/docker.html">Run Tiled Server in a Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/helm.html">Run Tiled Server from the Helm chart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/configuration.html">Serve Data using Configuration Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/read-custom-formats.html">Serve Files with Custom Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/custom-export-formats.html">Add Custom Export Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/api-keys.html">Create and Use API Keys</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/custom-clients.html">Custom Python Client Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/metrics.html">Prometheus Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/direct-client.html">Use Tiled in Python without an HTTP server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/tiled-authn-database.html">Set up a database for a scaled authenticated deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/register.html">Register Content in Tiled</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/retries.html">Control Retries</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Explanations</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="standards.html">Standards Used by Tiled</a></li>
<li class="toctree-l1"><a class="reference internal" href="structures.html">Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Metadata and “Specs”</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="compression.html">Compression</a></li>
<li class="toctree-l1"><a class="reference internal" href="specialized-formats.html">Case Study: Reading and Exporting a Specialized Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="caching.html">Caches</a></li>
<li class="toctree-l1"><a class="reference internal" href="access-control.html">Access Control</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Catalog Database</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#nodes">Nodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-source">Data Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="#structure">Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#asset">Asset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-source-asset-relation">Data Source Asset Relation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#single-hdf5-file">Single HDF5 file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#single-zarr-directory">Single Zarr directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#single-tiff-image">Single TIFF Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tiff-sequence">TIFF sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="#single-csv-file">Single CSV file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hdf5-file-with-virtual-datasets">HDF5 file with virtual datasets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#revisions">Revisions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#alembic-version">Alembic Version</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="lineage.html">How Tiled Fits into the Ecosystem</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/service.html">Service-side Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/http-api-overview.html">HTTP API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/python-client.html">Python Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/queries.html">Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/authentication.html">Authentication Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/scopes.html">Scopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/commandline.html">Command-line tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/service-configuration.html">Service Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/client-profiles.html">Client Profiles Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/release-history.html">Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/min-versions.html">Minimum Version of Python and NumPy</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tiled</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Catalog Database</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/explanations/catalog.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="catalog-database">
<h1>Catalog Database<a class="headerlink" href="#catalog-database" title="Link to this heading"></a></h1>
<p>The Catalog database is a SQL database of information describing data: its
name, metadata, structure, format, and location.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<pre  class="mermaid">
        erDiagram
    nodes ||--o{  data_sources : has
    data_sources ||--o{  data_source_asset_association : has
    data_source_asset_association }|--|{  assets : has
    data_sources }|--||   structure : has
    nodes ||--o{  revisions : has
    alembic_version

    </pre><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">nodes</span></code> - metadata and logical location of this dataset in Tiled’s tree</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data_sources</span></code> - format and parameters for opening dataset</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">structures</span></code> - description of dataset structure (e.g. shape, chunks, data type, column names, …)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assets</span></code> - location (URI) of data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data_source_asset_assocation</span></code> - many-to-many relation between <code class="docutils literal notranslate"><span class="pre">data_sources</span></code> and <code class="docutils literal notranslate"><span class="pre">assets</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">revisions</span></code> - snapshots of revision history of metadata</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alembic_version</span></code> - version of database schema, to verify compatibility with version of Tiled</p></li>
</ul>
</section>
<section id="nodes">
<h2>Nodes<a class="headerlink" href="#nodes" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">nodes</span></code> table is the <em>logical</em> view of the data, the way that Tiled
presents the data to clients. Each row represents one node in the logical
“tree” of data represented by Tiled.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">metadata</span></code> — user-controlled JSON object, with arbitrary metadata</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ancestors</span></code> and <code class="docutils literal notranslate"><span class="pre">key</span></code> — together specify the unique path of the data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">structre_family</span></code> — enum of structure types (<code class="docutils literal notranslate"><span class="pre">&quot;container&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;array&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;table&quot;</span></code>, …)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">specs</span></code> — user-controlled JSON list of specs, such as <code class="docutils literal notranslate"><span class="pre">[{&quot;name&quot;:</span> <span class="pre">&quot;XDI&quot;,</span> <span class="pre">&quot;version&quot;:</span> <span class="pre">&quot;1&quot;}]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> an internal integer primary key, not exposed by the API</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time_created</span></code> and <code class="docutils literal notranslate"><span class="pre">time_updated</span></code> — for forensics, not exposed by the API</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">time_created</span></code> and <code class="docutils literal notranslate"><span class="pre">time_updated</span></code> columns, which appear in this table and
others below, contain timestamps related to the corresponding database row
(Node, Data Source, Asset), not the underlying data files. They should not
carry a scientific meaning; they are only used for book-keeping, forensics,
and debugging.</p>
</section>
<section id="data-source">
<h2>Data Source<a class="headerlink" href="#data-source" title="Link to this heading"></a></h2>
<p>Each Data Source is associated with one Node. Together, <code class="docutils literal notranslate"><span class="pre">data_sources</span></code>, <code class="docutils literal notranslate"><span class="pre">structures</span></code>,
and <code class="docutils literal notranslate"><span class="pre">assets</span></code>, describes the format,  structure, and location of the data.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mimetype</span></code> — MIME type string describing the format, such as <code class="docutils literal notranslate"><span class="pre">&quot;text/csv&quot;</span></code>
(This is used by Tiled to identify a suitable Adapter to read this data.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parameters</span></code> — JSON object with additional parameters that will be passed
to the Adapter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">management</span></code> — enum indicating whether the data is registered <code class="docutils literal notranslate"><span class="pre">&quot;external&quot;</span></code> data
or <code class="docutils literal notranslate"><span class="pre">&quot;writable&quot;</span></code> data managed by Tiled</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">structure_family</span></code> — enum of structure types (<code class="docutils literal notranslate"><span class="pre">&quot;container&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;array&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;table&quot;</span></code>, …)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">structure_id</span></code> — a foreign key to the <code class="docutils literal notranslate"><span class="pre">structures</span></code> table</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">node_id</span></code> — foreign key to <code class="docutils literal notranslate"><span class="pre">nodes</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> — integer primary key</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time_created</span></code> and <code class="docutils literal notranslate"><span class="pre">time_updated</span></code> — for forensics, not exposed by the API</p></li>
</ul>
</section>
<section id="structure">
<h2>Structure<a class="headerlink" href="#structure" title="Link to this heading"></a></h2>
<p>Each Data Source references exactly one Structure.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">structure</span></code> — JSON object describing the structure</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> — MD5 hash of the <a class="reference external" href="https://www.rfc-editor.org/rfc/rfc8785">RFC 8785</a> canonical JSON of the structure</p></li>
</ul>
</section>
<section id="asset">
<h2>Asset<a class="headerlink" href="#asset" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data_uri</span></code> — location of data, given as <code class="docutils literal notranslate"><span class="pre">file://localhost/PATH</span></code>
(It is planned to extend to schemes other than <code class="docutils literal notranslate"><span class="pre">file</span></code>, such as <code class="docutils literal notranslate"><span class="pre">s3</span></code>, in the
future.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_directory</span></code> — boolean: <code class="docutils literal notranslate"><span class="pre">true</span></code> when the Asset being tracked is a
directory. This is used for data formats in which the directory structure is
an internal detail managed by the I/O library, such as Zarr and TileDB.
Otherwise this is <code class="docutils literal notranslate"><span class="pre">false</span></code>, and Tiled tracks each file as an individual Asset,
such as each TIFF file in a TIFF sequence, or each HDF5 file in a virtual
HDF5 dataset).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hash_type</span></code> and <code class="docutils literal notranslate"><span class="pre">hash_content</span></code> — not yet implemented (i.e. always NULL) but
intended for content verification</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">size</span></code> — not yet implemented (i.e. always NULL) but intended to support
fast queries for data size estimation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> — integer primary key</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time_created</span></code> and <code class="docutils literal notranslate"><span class="pre">time_updated</span></code> — for forensics, not exposed by the API</p></li>
</ul>
</section>
<section id="data-source-asset-relation">
<h2>Data Source Asset Relation<a class="headerlink" href="#data-source-asset-relation" title="Link to this heading"></a></h2>
<p>Assets and Data Sources have a many-to-many relation. The
<code class="docutils literal notranslate"><span class="pre">data_source_asset_assocation</span></code> table is best described by the example below.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data_source_id</span></code>, <code class="docutils literal notranslate"><span class="pre">asset_id</span></code> — foreign keys</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parameter</span></code> — the name of the Tiled Adapter’s parameter that this Asset
should be passed to, e.g. <code class="docutils literal notranslate"><span class="pre">&quot;data_uri&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;data_uris&quot;</span></code>. These can be any
string because some Adapters handle a heterogeneous group of Assets, like
a combination of an image file and a separate text metadata file, and
load them as a unit. The parameter is used to differentiate the various
Assets for the Adapter.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num</span></code> — the position of this item in a list</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">parameter</span></code> is NULL, the Asset is a supporting file, not passed directly to
the Adapter.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">num</span></code> is NULL, the Adapter will be passed a scalar value. If <code class="docutils literal notranslate"><span class="pre">num</span></code> is an
integer, the Adapter will be passed a list sorted by <code class="docutils literal notranslate"><span class="pre">num</span></code>.</p>
<p>Database triggers are used to ensure self-consistency.</p>
<section id="single-hdf5-file">
<h3>Single HDF5 file<a class="headerlink" href="#single-hdf5-file" title="Link to this heading"></a></h3>
<p>This is a simple example: one Data Source and one associated Asset.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">mimetype</span><span class="p">,</span><span class="w"> </span><span class="k">parameters</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">data_sources</span><span class="p">;</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>id</p></th>
<th class="head"><p>mimetype</p></th>
<th class="head"><p>parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>“application/x-hdf5”</p></td>
<td><p>{“smwr”: true}</p></td>
</tr>
</tbody>
</table>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">data_uri</span><span class="p">,</span><span class="w"> </span><span class="n">is_diretory</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">assets</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>id</p></th>
<th class="head"><p>data_uri</p></th>
<th class="head"><p>is_directory</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>“file://localhost/path/to/data.h5”</p></td>
<td><p>false</p></td>
</tr>
</tbody>
</table>
<p>The HDF5 Adapter takes one HDF5 file passed to the argument
named <code class="docutils literal notranslate"><span class="pre">data_uri</span></code>, so the Asset is given parameter <code class="docutils literal notranslate"><span class="pre">&quot;data_uri&quot;</span></code>
and num <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">data_source_asset_assocation</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>data_source_id</p></th>
<th class="head"><p>asset_id</p></th>
<th class="head"><p>parameter</p></th>
<th class="head"><p>num</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>“data_uri”</p></td>
<td><p>NULL</p></td>
</tr>
</tbody>
</table>
</section>
<section id="single-zarr-directory">
<h3>Single Zarr directory<a class="headerlink" href="#single-zarr-directory" title="Link to this heading"></a></h3>
<p>This is similar. A single Zarr dataset is backed by a directory, not a
file. The internal structure of the directory is managed by Zarr, not by the
user, so Tiled can simply track the whole directory as a unit, not each
individual file.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">mimetype</span><span class="p">,</span><span class="w"> </span><span class="k">parameters</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">data_sources</span><span class="p">;</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>id</p></th>
<th class="head"><p>mimetype</p></th>
<th class="head"><p>parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>“application/x-zarr”</p></td>
<td><p>{}</p></td>
</tr>
</tbody>
</table>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">data_uri</span><span class="p">,</span><span class="w"> </span><span class="n">is_diretory</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">assets</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>id</p></th>
<th class="head"><p>data_uri</p></th>
<th class="head"><p>is_directory</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>“file://localhost/path/to/data.zarr”</p></td>
<td><p>true</p></td>
</tr>
</tbody>
</table>
<p>(Notice <code class="docutils literal notranslate"><span class="pre">is_directory</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code>.)</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">data_source_asset_assocation</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>data_source_id</p></th>
<th class="head"><p>asset_id</p></th>
<th class="head"><p>parameter</p></th>
<th class="head"><p>num</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>“data_uri”</p></td>
<td><p>NULL</p></td>
</tr>
</tbody>
</table>
</section>
<section id="single-tiff-image">
<h3>Single TIFF Image<a class="headerlink" href="#single-tiff-image" title="Link to this heading"></a></h3>
<p>This is another simple example, very much like the HDF5 example.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">mimetype</span><span class="p">,</span><span class="w"> </span><span class="k">parameters</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">data_sources</span><span class="p">;</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>id</p></th>
<th class="head"><p>mimetype</p></th>
<th class="head"><p>parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>“image/tiff”</p></td>
<td><p>{}</p></td>
</tr>
</tbody>
</table>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">data_uri</span><span class="p">,</span><span class="w"> </span><span class="n">is_diretory</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">assets</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>id</p></th>
<th class="head"><p>data_uri</p></th>
<th class="head"><p>is_directory</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>“file://localhost/path/to/image.tiff”</p></td>
<td><p>false</p></td>
</tr>
</tbody>
</table>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">data_source_asset_assocation</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>data_source_id</p></th>
<th class="head"><p>asset_id</p></th>
<th class="head"><p>parameter</p></th>
<th class="head"><p>num</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>“data_uri”</p></td>
<td><p>NULL</p></td>
</tr>
</tbody>
</table>
</section>
<section id="tiff-sequence">
<h3>TIFF sequence<a class="headerlink" href="#tiff-sequence" title="Link to this heading"></a></h3>
<p>Now we have a sequence of separate TIFF files (<code class="docutils literal notranslate"><span class="pre">image00001.tiff</span></code>,
<code class="docutils literal notranslate"><span class="pre">image00002.tiff</span></code>, …) that we want to treat as a single Data Source.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">mimetype</span><span class="p">,</span><span class="w"> </span><span class="k">parameters</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">data_sources</span><span class="p">;</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>id</p></th>
<th class="head"><p>mimetype</p></th>
<th class="head"><p>parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>“multipart/related;type=image/tiff”</p></td>
<td><p>{}</p></td>
</tr>
</tbody>
</table>
<p>The MIME type <code class="docutils literal notranslate"><span class="pre">multipart/related;type=image/tiff</span></code> is registered to an Adapter
that expects a <em>sequence</em> of TIFF files, e.g. <code class="docutils literal notranslate"><span class="pre">TiffSequenceAdapter</span></code>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">data_uri</span><span class="p">,</span><span class="w"> </span><span class="n">is_diretory</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">assets</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>id</p></th>
<th class="head"><p>data_uri</p></th>
<th class="head"><p>is_directory</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>“file://localhost/path/to/image00001.tiff”</p></td>
<td><p>false</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>“file://localhost/path/to/image00002.tiff”</p></td>
<td><p>false</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>“file://localhost/path/to/image00003.tiff”</p></td>
<td><p>false</p></td>
</tr>
</tbody>
</table>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">data_source_asset_assocation</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>data_source_id</p></th>
<th class="head"><p>asset_id</p></th>
<th class="head"><p>parameter</p></th>
<th class="head"><p>num</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>“data_uris”</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>2</p></td>
<td><p>“data_uris”</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>3</p></td>
<td><p>“data_uris”</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
</section>
<section id="single-csv-file">
<h3>Single CSV file<a class="headerlink" href="#single-csv-file" title="Link to this heading"></a></h3>
<p>The CSV Adapter is designed to accept multiple CSV partitions
representing batches (a.k.a. partitions) of rows.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">mimetype</span><span class="p">,</span><span class="w"> </span><span class="k">parameters</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">data_sources</span><span class="p">;</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>id</p></th>
<th class="head"><p>mimetype</p></th>
<th class="head"><p>parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>“text/csv”</p></td>
<td><p>{}</p></td>
</tr>
</tbody>
</table>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">data_uri</span><span class="p">,</span><span class="w"> </span><span class="n">is_diretory</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">assets</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>id</p></th>
<th class="head"><p>data_uri</p></th>
<th class="head"><p>is_directory</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>“file://localhost/path/to/table.csv”</p></td>
<td><p>false</p></td>
</tr>
</tbody>
</table>
<p>The CSV Adapter takes one or more CSV passed as a list to the
argument named <code class="docutils literal notranslate"><span class="pre">data_uris</span></code>, so the Asset is given parameter
<code class="docutils literal notranslate"><span class="pre">data_uris</span></code> and num <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">data_source_asset_assocation</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>data_source_id</p></th>
<th class="head"><p>asset_id</p></th>
<th class="head"><p>parameter</p></th>
<th class="head"><p>num</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>“data_uris”</p></td>
<td><p>0</p></td>
</tr>
</tbody>
</table>
</section>
<section id="hdf5-file-with-virtual-datasets">
<h3>HDF5 file with virtual datasets<a class="headerlink" href="#hdf5-file-with-virtual-datasets" title="Link to this heading"></a></h3>
<p>Here is an example where we set parameter to NULL.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">mimetype</span><span class="p">,</span><span class="w"> </span><span class="k">parameters</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">data_sources</span><span class="p">;</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>id</p></th>
<th class="head"><p>mimetype</p></th>
<th class="head"><p>parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>“application/x-hdf5”</p></td>
<td><p>{}</p></td>
</tr>
</tbody>
</table>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">data_uri</span><span class="p">,</span><span class="w"> </span><span class="n">is_diretory</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">assets</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>id</p></th>
<th class="head"><p>data_uri</p></th>
<th class="head"><p>is_directory</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>“file://localhost/path/to/master.h5”</p></td>
<td><p>false</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>“file://localhost/path/to/data00001.h5”</p></td>
<td><p>false</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>“file://localhost/path/to/data00002.h5”</p></td>
<td><p>false</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>“file://localhost/path/to/data00003.h5”</p></td>
<td><p>false</p></td>
</tr>
</tbody>
</table>
<p>The CSV Adapter takes one or more CSV passed as a list to the
argument named <code class="docutils literal notranslate"><span class="pre">data_uris</span></code>, so the Asset is given parameter
<code class="docutils literal notranslate"><span class="pre">data_uris</span></code> and num <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">data_source_asset_assocation</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>data_source_id</p></th>
<th class="head"><p>asset_id</p></th>
<th class="head"><p>parameter</p></th>
<th class="head"><p>num</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>“data_uri”</p></td>
<td><p>NULL</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>2</p></td>
<td><p>NULL</p></td>
<td><p>NULL</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>3</p></td>
<td><p>NULL</p></td>
<td><p>NULL</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>4</p></td>
<td><p>NULL</p></td>
<td><p>NULL</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="revisions">
<h2>Revisions<a class="headerlink" href="#revisions" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">revisions</span></code> table stores snapshots of Node <code class="docutils literal notranslate"><span class="pre">metadata</span></code> and <code class="docutils literal notranslate"><span class="pre">specs</span></code>. When an
update is made, the row in the <code class="docutils literal notranslate"><span class="pre">nodes</span></code> table is updated and a <em>copy</em> with the
original content is inserted in the <code class="docutils literal notranslate"><span class="pre">revisions</span></code> table.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">node_id</span></code> — foreign key to the node</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">revision_number</span></code> — integer counting revisions of this node from 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">metadata</span></code> — snapshot of node metadata</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">specs</span></code> — snapshot of node specs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> — an internal integer primary key, not exposed by the API</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time_created</span></code> and <code class="docutils literal notranslate"><span class="pre">time_updated</span></code> — for forensics, not exposed by the API</p></li>
</ul>
</section>
<section id="alembic-version">
<h2>Alembic Version<a class="headerlink" href="#alembic-version" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">alembic_version</span></code> table is managed by <a class="reference external" href="https://alembic.sqlalchemy.org/en/latest/">Alembic</a>, a SQL migration tool, to
stamp the current version of the database. The Tiled server checks this at
startup to ensure that the version of Tiled being used is compatible with the
version of the database.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="access-control.html" class="btn btn-neutral float-left" title="Access Control" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="faq.html" class="btn btn-neutral float-right" title="FAQ" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Bluesky Collaboration.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>