<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Use Profiles to streamline Python client setup &mdash; tiled 0.1.0a40.post15+g6a30ac0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Use Tiled in Python without an HTTP server" href="direct-client.html" />
    <link rel="prev" title="Add Support for a Custom Format" href="custom-formats.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> tiled
          </a>
              <div class="version">
                0.1.0a40.post15+g6a30ac0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/navigation.html">Navigate with the Python Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/slicing.html">Load Slices of Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/caching.html">Keep a Local Copy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/export.html">Deliberate Export</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/login.html">Log into an Authenticated Tiled Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/serving-files.html">Serve a Directory of Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/search.html">Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/plotly-integration.html">Plot Data in Plotly Chart Studio</a></li>
</ul>
<p class="caption"><span class="caption-text">How To Guides</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Serve Trees using Configuration Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom-formats.html">Add Support for a Custom Format</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Use Profiles to streamline Python client setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-problem-do-profiles-solve">What problem do profiles solve?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#where-are-profiles-kept">Where are profiles kept?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-and-use-a-profile">Create and use a profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="#list-profiles">List profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#view-profiles">View profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#merging-rules">Merging rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-direct-profiles">Advanced: “Direct” Profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="direct-client.html">Use Tiled in Python without an HTTP server</a></li>
<li class="toctree-l1"><a class="reference internal" href="tune-caches.html">Tune Caches to Balance Speed and Memory Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Run Tiled using Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Explanations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../explanations/structures.html">Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanations/security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanations/compression.html">Compression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanations/caching.html">Caching Design and Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanations/access-control.html">Access Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanations/scaling-down.html">Scaling Tiled Down</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanations/faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanations/lineage.html">How Tiled Fits into the Ecosystem</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/service.html">Service-side Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/http-api-overview.html">HTTP API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/python-client.html">Python Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/authentication.html">Authentication Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/authentication.html#configure-session-lifetime-parameters">Configure session lifetime parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/commandline.html">Command-line tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/service-configuration.html">Service Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/client-profiles.html">Client Profiles Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/design-documents/index.html">Design Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/release-history.html">Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/min-versions.html">Minimum Version of Python and NumPy</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tiled</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Use Profiles to streamline Python client setup</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/how-to/profiles.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="use-profiles-to-streamline-python-client-setup">
<h1>Use Profiles to streamline Python client setup<a class="headerlink" href="#use-profiles-to-streamline-python-client-setup" title="Permalink to this headline">¶</a></h1>
<section id="what-problem-do-profiles-solve">
<h2>What problem do profiles solve?<a class="headerlink" href="#what-problem-do-profiles-solve" title="Permalink to this headline">¶</a></h2>
<p>Profiles provide a shorthand for constructing clients. A profile stores client
parameters in a file and gives them an alias, so that something like this:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tiled.client</span> <span class="kn">import</span> <span class="n">from_uri</span>
<span class="kn">from</span> <span class="nn">tiled.client.cache</span> <span class="kn">import</span> <span class="n">Cache</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">from_uri</span><span class="p">(</span><span class="s2">&quot;http://some_server_address&quot;</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="n">Cache</span><span class="o">.</span><span class="n">on_disk</span><span class="p">(</span><span class="s2">&quot;path/to/cache&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>can be replaced with the more memorable and succinct</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tiled.client</span> <span class="kn">import</span> <span class="n">from_profile</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">from_profile</span><span class="p">(</span><span class="s2">&quot;my_data&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">my_data</span></code> can be any name you wish and the parameters are written down
once like so:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">my_data</span><span class="p">:</span>
    <span class="nt">uri</span><span class="p">:</span> <span class="s">&quot;http://some_server_address&quot;</span>
    <span class="nt">cache</span><span class="p">:</span>
        <span class="nt">disk</span><span class="p">:</span>
            <span class="nt">path</span><span class="p">:</span> <span class="s">&quot;path/to/cache&quot;</span>
</pre></div>
</div>
</section>
<section id="where-are-profiles-kept">
<h2>Where are profiles kept?<a class="headerlink" href="#where-are-profiles-kept" title="Permalink to this headline">¶</a></h2>
<p>Profiles are specified in YAML files located in any of several locations. To
list where Tiled looks for profiles on your system, use the command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tiled profile paths
</pre></div>
</div>
<p>or Python:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tiled.profiles</span> <span class="kn">import</span> <span class="n">paths</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">paths</span>
</pre></div>
</div>
<p>Within these directories, you may have:</p>
<ul class="simple">
<li><p>Any number of configuration files</p></li>
<li><p>Named whatever you want</p></li>
<li><p>With one or more profiles per configuration file</p></li>
</ul>
<p>That is, you can keep one file with all your profiles or organize them
by grouping them into several separate files, named whatever you want.</p>
<p>The paths later in the list—“closer to the user”—take precedence in the
event of name collisions. See the section on Merging Rules below for details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Tiled always looks in three places for profiles:</p>
<ol class="simple">
<li><p>A system-wide directory. This is used by <em>administrators</em> to
distribute profiles that all users can see.</p></li>
<li><p>A directory in the currently active Python software environment
(for example, the conda environment). This is used by
<em>software packages</em> to distribute profiles that support their
software.</p></li>
<li><p>A user-controlled directory (a subdirectory of <code class="docutils literal notranslate"><span class="pre">$HOME</span></code>). This is
for users’ personal productivity.</p></li>
</ol>
<p>The exact locations depend on which operating system you are using and other
system-specific details, in accordance with standards, which is why we can’t
list them here.</p>
<p>The default locations for (1) and (3) can be overridden by setting the
environment variables <code class="docutils literal notranslate"><span class="pre">TILED_SITE_PROFILES</span></code> and <code class="docutils literal notranslate"><span class="pre">TILED_PROFILES</span></code>, respectively,
to the desired path.</p>
</div>
</section>
<section id="create-and-use-a-profile">
<h2>Create and use a profile<a class="headerlink" href="#create-and-use-a-profile" title="Permalink to this headline">¶</a></h2>
<p>Place a file in one of the directories listed in the previous section.
The last directory in the list, the “user” one, is a good place to start.
The filename can be anything. To start, <code class="docutils literal notranslate"><span class="pre">profiles.yml</span></code> is as good a name as any.</p>
<p>As an example, use the content:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># profiles.yml</span>
<span class="nt">local</span><span class="p">:</span>
   <span class="nt">uri</span><span class="p">:</span> <span class="s">&quot;http://localhost:8000&quot;</span>
   <span class="nt">cache</span><span class="p">:</span>
       <span class="nt">memory</span><span class="p">:</span>
           <span class="nt">available_bytes</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2_000_000_000</span>  <span class="c1"># 2 GB</span>
<span class="nt">local_dask</span><span class="p">:</span>
   <span class="nt">uri</span><span class="p">:</span> <span class="s">&quot;http://localhost:8000&quot;</span>
   <span class="nt">structure_clients</span><span class="p">:</span> <span class="s">&quot;dask&quot;</span>
   <span class="nt">cache</span><span class="p">:</span>
       <span class="nt">memory</span><span class="p">:</span>
           <span class="nt">available_bytes</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2_000_000_000</span>  <span class="c1"># 2 GB</span>
</pre></div>
</div>
<p>Now we have two profiles that aim at a local server, one with default (numpy)
clients and one with dask clients. While running a local tiled server such as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tiled</span> <span class="n">serve</span> <span class="n">pyobject</span> <span class="o">--</span><span class="n">public</span> <span class="n">tiled</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">generated_minimal</span><span class="p">:</span><span class="n">tree</span>
</pre></div>
</div>
<p>we can succinctly create clients like</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tiled.client</span> <span class="kn">import</span> <span class="n">from_profile</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">from_profile</span><span class="p">(</span><span class="s2">&quot;local&quot;</span><span class="p">)</span>
<span class="n">lazy_client</span> <span class="o">=</span> <span class="n">from_profile</span><span class="p">(</span><span class="s2">&quot;local_dask&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="list-profiles">
<h2>List profiles<a class="headerlink" href="#list-profiles" title="Permalink to this headline">¶</a></h2>
<p>To list the names of the profiles on your system, along with the path to the
file where each one is defined…</p>
<p>From the shell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tiled profile list
</pre></div>
</div>
<p>From Python:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tiled.profiles</span> <span class="kn">import</span> <span class="n">list_profiles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_profiles</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="view-profiles">
<h2>View profiles<a class="headerlink" href="#view-profiles" title="Permalink to this headline">¶</a></h2>
<p>To show the contents of a profile…</p>
<p>From the shell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tiled profile show PROFILE_NAME
</pre></div>
</div>
<p>From Python:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tiled.profiles</span> <span class="kn">import</span> <span class="n">load_profiles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">load_profiles</span><span class="p">()</span>  <span class="c1"># show all, given as {profile_name: (filepath, content)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">load_profiles</span><span class="p">()[</span><span class="n">PROFILE_NAME</span><span class="p">]</span>  <span class="c1"># show one (filepath, content)</span>
</pre></div>
</div>
</section>
<section id="merging-rules">
<h2>Merging rules<a class="headerlink" href="#merging-rules" title="Permalink to this headline">¶</a></h2>
<p>Situation #1: In the event of a name collision <em>within one file</em> like:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">my_profile</span><span class="p">:</span>
   <span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nt">my_proifile</span><span class="p">:</span>  <span class="c1"># oops, reused the same name</span>
   <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
<p>the second one will win. (This is just how YAML works. We wish we could
issue a warning or something to let you know that something looks off,
but we have no way to do that without going to great lengths.)</p>
<p>Situation #2: In the event of a name collision between files in different
directories, the one in the directory “closer to the user”—later in the list
of paths—will take precedence. No warning will be issued. This the normal way
for users to override a default system- or environment-level configuration with
their own preferences.</p>
<p>Situation #3: In the event of a name collision between two files in the same directory:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># some/directory/some_profiles.yaml</span>
<span class="nt">my_profile</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># some/directory/yet_more_profiles.yaml</span>
<span class="nt">my_profile</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
<p>Tiled has no way of guessing which is “right” so it refuses to load either one,
and it issues a warning indicating that this profile will be skipped until
the issue is resolved.</p>
<p>If the collision occurs in the system or software environment directory and you
do not have the access necessary to edit those configurations and resolve the
issue, you can override the problematic name by defining a new profile with that
name in your user configuration directory. As described in Situation #2, the version
in the user configuration directory will take precedence.  The collision will
therefore become irrelevant and will be ignored.</p>
<p>If the collision occurs in the user directory, then you (of course) have
the access necessary to fix it, and you should.</p>
</section>
<section id="advanced-direct-profiles">
<h2>Advanced: “Direct” Profiles<a class="headerlink" href="#advanced-direct-profiles" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Return to this section after reading  <a class="reference internal" href="direct-client.html"><span class="doc">Use Tiled in Python without an HTTP server</span></a>.</p>
</div>
<p>For development and debugging, it can be convenient to place service and client
configuration together in a profile. To do this, include the special key
<code class="docutils literal notranslate"><span class="pre">direct:</span></code> with the <em>service-side</em> configuration nested inside of it.</p>
<p>Here is a complete example.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># profiles.yml</span>
<span class="nt">my_profile</span><span class="p">:</span>
    <span class="nt">direct</span><span class="p">:</span>
        <span class="nt">trees</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
            <span class="nt">tree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tiled.trees.files:Tree.from_directory</span>
            <span class="nt">args</span><span class="p">:</span>
                <span class="nt">directory</span><span class="p">:</span> <span class="s">&quot;path/to/files&quot;</span>
</pre></div>
</div>
<p>This takes the place of the <code class="docutils literal notranslate"><span class="pre">uri:</span></code> parameter. A profile must contain
<em>either</em> <code class="docutils literal notranslate"><span class="pre">uri:</span></code> or <code class="docutils literal notranslate"><span class="pre">direct:</span></code> but not both. It can sit alongside other
usual client-side configuration, such as</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># profiles.yml</span>
<span class="nt">my_profile</span><span class="p">:</span>
    <span class="nt">direct</span><span class="p">:</span>
        <span class="nt">trees</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
            <span class="nt">tree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tiled.trees.files:Tree.from_directory</span>
            <span class="nt">args</span><span class="p">:</span>
                <span class="nt">directory</span><span class="p">:</span> <span class="s">&quot;path/to/files&quot;</span>
    <span class="nt">cache</span><span class="p">:</span>
        <span class="nt">memory</span><span class="p">:</span>
            <span class="nt">available_bytes</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2_000_000_000</span> <span class="c1"># 2 GB</span>
</pre></div>
</div>
</section>
<section id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="../reference/client-profiles.html"><span class="doc">Client Profiles Reference</span></a> for a comprehensive reference.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="custom-formats.html" class="btn btn-neutral float-left" title="Add Support for a Custom Format" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="direct-client.html" class="btn btn-neutral float-right" title="Use Tiled in Python without an HTTP server" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Bluesky Collaboration.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>