<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Command-Line Tools &mdash; bluesky-queueserver 0.0.18.post138+g752bd21 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="RE Manager Configuration" href="manager_config.html" />
    <link rel="prev" title="bluesky_queueserver.parameter_annotation_decorator" href="generated/bluesky_queueserver.parameter_annotation_decorator.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            bluesky-queueserver
          </a>
              <div class="version">
                0.0.18.post138+g752bd21
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_history.html">Release History</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/bluesky/bluesky-queueserver">Source Code on GitHub</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User's Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction_for_users.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_queue_server.html">Using the Queue Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="features_and_config.html">Features and Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="startup_code.html">Organizing Bluesky Startup Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="ipython.html">Using IPython Startup Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="item_validation.html">Validation of Queue Items</a></li>
<li class="toctree-l1"><a class="reference internal" href="plan_annotation.html">Annotating Bluesky Plans</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Command-Line Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#start-re-manager">start-re-manager</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-a-configuration-files">Using a Configuration Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Location of Startup Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#instances-of-run-engine-and-databroker">Instances of Run Engine and Databroker</a></li>
<li class="toctree-l3"><a class="reference internal" href="#updating-the-list-of-existing-plans-and-devices">Updating the List of Existing Plans and Devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#console-ouput">Console Ouput</a></li>
<li class="toctree-l3"><a class="reference internal" href="#encryption-for-0mq-control-communication-channel">Encryption for 0MQ Control Communication Channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-configuration-parameters">Other Configuration Parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#qserver">qserver</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qserver-list-plans-devices">qserver-list-plans-devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qserver-zmq-keys">qserver-zmq-keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qserver-console-monitor">qserver-console-monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qserver-clear-lock">qserver-clear-lock</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qserver-console">qserver-console</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qserver-qtconsole">qserver-qtconsole</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="manager_config.html">RE Manager Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="qserver_quick_ref.html"><em>qserver</em> : Quick Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Application Developer's Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="interacting_with_qs.html">Interacting with Queue Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="re_manager_api.html">Run Engine Manager API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Related Projects</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/bluesky-queueserver-api">Bluesky Queue Server API</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/bluesky-httpserver">Bluesky HTTP Server</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/bluesky-widgets">Bluesky Widgets</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/bluesky">Bluesky</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/ophyd">Ophyd</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/databroker">Data Broker</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">bluesky-queueserver</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Command-Line Tools</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/cli_tools.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="command-line-tools">
<h1>Command-Line Tools<a class="headerlink" href="#command-line-tools" title="Permalink to this heading">¶</a></h1>
<p>The CLI tools are installed with the <em>bluesky-queueserver</em> package:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#start-re-manager-cli"><span class="std std-ref">start-re-manager</span></a> - start RE Manager.</p></li>
<li><p><a class="reference internal" href="#qserver-cli"><span class="std std-ref">qserver</span></a> - communicate with RE Manager over 0MQ.</p></li>
<li><p><a class="reference internal" href="#qserver-list-plans-devices-cli"><span class="std std-ref">qserver-list-plans-devices</span></a> - generate list of existing plans and devices, validate startup code.</p></li>
<li><p><a class="reference internal" href="#qserver-zmq-keys-cli"><span class="std std-ref">qserver-zmq-keys</span></a> - generate key pair for encryption of 0MQ control channel.</p></li>
<li><p><a class="reference internal" href="#qserver-console-monitor-cli"><span class="std std-ref">qserver-console-monitor</span></a> - simple monitor of RE Manager console output.</p></li>
<li><p><a class="reference internal" href="#qserver-clear-lock-cli"><span class="std std-ref">qserver-clear-lock</span></a> - unlock RE Manager if the lock key is lost.</p></li>
<li><p><a class="reference internal" href="#qserver-console-cli"><span class="std std-ref">qserver-console</span></a> - start Jupyter Console connected to IPython kernel running in the worker.</p></li>
<li><p><a class="reference internal" href="#qserver-qtconsole-cli"><span class="std std-ref">qserver-qtconsole</span></a> - start Jupyter Qt Console connected to IPython kernel running in the worker.</p></li>
</ul>
<section id="start-re-manager">
<span id="start-re-manager-cli"></span><h2>start-re-manager<a class="headerlink" href="#start-re-manager" title="Permalink to this heading">¶</a></h2>
<p>The command starts Run Engine (RE) Manager on the workstation. If no parameters are
specified, RE Manager is started in demo mode (built-in startup files with simulated
devices and plans will be used). Demo mode is intended for evaluation and testing
of Queue Server. The CLI parameters may be used to customize RE Manager and specify
the location of beamline startup scripts.</p>
<section id="using-a-configuration-files">
<span id="location-of-startup-code"></span><h3>Using a Configuration Files<a class="headerlink" href="#using-a-configuration-files" title="Permalink to this heading">¶</a></h3>
<p>RM Manager can be customized using a config file (YML). Combining the parameters
in a single config file may be more convenient in production deployments. The path
to config file is passed to the manager using environment variable <code class="docutils literal notranslate"><span class="pre">QSERVER_CONFIG</span></code>
or using CLI parameter <code class="docutils literal notranslate"><span class="pre">--config</span></code>. CLI parameters passed to <code class="docutils literal notranslate"><span class="pre">start-re-manager</span></code>
override the parameters set in config file or passed using environment variables.</p>
</section>
<section id="id1">
<h3>Location of Startup Code<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<p>RE Manager may create RE Worker environments based based on startup code from
IPython-style collection of startup scripts, Python script or Python module.
The locations of autogenerated <code class="docutils literal notranslate"><span class="pre">existing_plans_and_devices.yaml</span></code> file (see
<a class="reference internal" href="#update-existing-plans-devices"><span class="std std-ref">Updating the List of Existing Plans and Devices</span></a> and
<a class="reference internal" href="#qserver-list-plans-devices-cli"><span class="std std-ref">qserver-list-plans-devices</span></a>) and <code class="docutils literal notranslate"><span class="pre">user_group_permissions.yaml</span></code>
must also be specified. The <code class="docutils literal notranslate"><span class="pre">existing_plans_and_devices.yaml</span></code> file is
optional and could be generated automatically by opening RE Worker environment,
but the path to the file pointing to a location in existing directory must be
properly specified. Alternatively, the file can be initially generated by
<code class="docutils literal notranslate"><span class="pre">qserver_list_plans_devices</span></code> CLI tool.</p>
<p><strong>IPython-style collection of startup scripts:</strong>
Use the parameter <code class="docutils literal notranslate"><span class="pre">--startup-dir</span></code> to specify the directory path to
the collection of startup file. Both <code class="docutils literal notranslate"><span class="pre">.yaml</span></code> files are expected to be
located in the startup directory. If the location the <code class="docutils literal notranslate"><span class="pre">.yaml</span></code> files is different,
use the parameters <code class="docutils literal notranslate"><span class="pre">--existing-plans-devices</span></code> and <code class="docutils literal notranslate"><span class="pre">--user-group-permissions</span></code>
to specify the correct paths.</p>
<p><strong>Ipython profile:</strong>
If the collection of startup scripts is located in <code class="docutils literal notranslate"><span class="pre">startup</span></code> directory in
one of the IPython profiles, the profile name may be passed to RE Manager
using the parameter <code class="docutils literal notranslate"><span class="pre">--startup-profile</span></code>. This option is implemented for
convenience and allows to avoid specifying long path to startup directory.</p>
<p><strong>Python script:</strong>
Use the parameter <code class="docutils literal notranslate"><span class="pre">--startup-script</span></code> to specify the path to Python
script that contains startup code (<code class="docutils literal notranslate"><span class="pre">.py</span></code> file). Only the single script
will be loaded. The script may contain imports from other scripts or modules.
Since there is no obvious location for the <code class="docutils literal notranslate"><span class="pre">.yaml</span></code> files, the paths
to the files must be explicitely specified using parameters
<code class="docutils literal notranslate"><span class="pre">--existing-plans-devices</span></code> and <code class="docutils literal notranslate"><span class="pre">--user-group-permissions</span></code>.</p>
<p><strong>Python module:</strong>
Use the parameter <code class="docutils literal notranslate"><span class="pre">--startup-module</span></code> to specify the name of the installed
module that contains startup code. Paths to both <code class="docutils literal notranslate"><span class="pre">.yaml</span></code> files must be
explicitly specified.</p>
</section>
<section id="instances-of-run-engine-and-databroker">
<h3>Instances of Run Engine and Databroker<a class="headerlink" href="#instances-of-run-engine-and-databroker" title="Permalink to this heading">¶</a></h3>
<p>By default, RE Manager removes <code class="docutils literal notranslate"><span class="pre">RE</span></code> and <code class="docutils literal notranslate"><span class="pre">db</span></code> objects from RE Worker
namespace and creates the new instances. In many cases, startup scripts contain
the code that creates and configures instances <code class="docutils literal notranslate"><span class="pre">RE</span></code> and/or <code class="docutils literal notranslate"><span class="pre">db</span></code>.
To disable the default behavior and keep instances of <code class="docutils literal notranslate"><span class="pre">RE</span></code> and <code class="docutils literal notranslate"><span class="pre">db</span></code>
created in startup scripts, start RE Manager with the parameter <code class="docutils literal notranslate"><span class="pre">--keep-re</span></code>.
RE Worker environment will fail to open if <code class="docutils literal notranslate"><span class="pre">--keep-re</span></code> is used and startup
scripts do not create the instance of <code class="docutils literal notranslate"><span class="pre">RE</span></code>.</p>
<p>RE Manager supports a number of standard options of subscribing <code class="docutils literal notranslate"><span class="pre">RE</span></code> to callbacks.
All the subscriptions can be performed in startup code, so those options
are implemented mostly for convenience. The options work in cases when
<code class="docutils literal notranslate"><span class="pre">RE</span></code> is created in startup script or RE Manager. (Note, that <code class="docutils literal notranslate"><span class="pre">--keep-re</span></code>
must be used to preserve the instance of <code class="docutils literal notranslate"><span class="pre">RE</span></code> created in the startup script.
The parameters supporting the subscription options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--databroker-config</span></code> subscribes RE to Data Broker with the given
configuration name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--zmq-data-proxy-addr</span></code> address of 0MQ proxy for publishing
documents generated by Run Engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--kafka-server</span></code> and <code class="docutils literal notranslate"><span class="pre">--kafka-topic</span></code> for publishing
documents generated by Run Engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--use-persistent-metadata</span></code> enables msgpack-based persistent storage
for scan metadata</p></li>
</ul>
</section>
<section id="updating-the-list-of-existing-plans-and-devices">
<span id="update-existing-plans-devices"></span><h3>Updating the List of Existing Plans and Devices<a class="headerlink" href="#updating-the-list-of-existing-plans-and-devices" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">--update-existing-plans-devices</span></code> parameter determines when the lists of existing plans
and devices stored in a disk file is updated by Queue Server. See notes on the location of
the file with the lists of existing plans and devices in <a class="reference internal" href="#location-of-startup-code"><span class="std std-ref">Using a Configuration Files</span></a>.
The lists are loaded from the disk file by RE Manager process at startup and used to generate
the initial lists of allowed plans and devices. Those lists are used for validation of
submitted plans, allowing user to submit plans to the queue before startup scripts are
loaded. The lists are also distributed to clients and used for generating user interfaces.
Therefore, it is important to keep the stored lists of existing plans and devices up to date.
The parameter allows to select between the following modes for updating the lists:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">NEVER</span></code> - Queue Server never overwrites the existing file or create a new file if it
is missing. Users need to update the file by manually running <code class="docutils literal notranslate"><span class="pre">qserver-list-plans-devices</span></code>
CLI tool. Opening the RE Worker environment generates the lists of existing plans and
devices that could be used during the current session, but it will not be saved to the file.
The next time Queue Server is started, the original lists of existing plans and devices
is loaded from disk. <a class="reference internal" href="re_manager_api.html#method-permissions-reload"><span class="std std-ref">‘permissions_reload’</span></a> 0MQ API called with parameter
<code class="docutils literal notranslate"><span class="pre">restore_plans_devices=True</span></code> will also reload the original list from disk. Restarting
the RE Manager process while the environment is open will not read the list of existing
plans and devices from disk. This option may be used in workflows with ‘static’, rarely
changed startup scripts where it is preferred that the lists of existing plans and devices
is not dynamically changed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ENVIRONMENT_OPEN</span></code> (default) - Queue Server verifies if the lists of existing plans
and devices are out of date each time RE Worker environment is opened and saves the new
lists to the file when necessary. This ensures that the next time Queue Server is started,
the latest up-to-date version of the lists is loaded. In this mode, it is not necessary
to call use <code class="docutils literal notranslate"><span class="pre">qserver-list-plans-devices</span></code> to generate the lists. Instead it could be left
to Queue Server to update the stored lists. Note, that Queue Server will not know about
changes to startup code until the operation of opening RE Worker environment is successfully
completed. <code class="docutils literal notranslate"><span class="pre">qserver-list-plans-devices</span></code> may still be useful for debugging the startup
code or generating lists of existing plans and devices in cases when starting Queue
Server is inconvenient.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ALWAYS</span></code> - Queue Server updates the lists of existing plans and devices stored in file
each time plans and devices are added to or removed from to RE namespace. This is option
is not fully utilized yet and results in behavior identical to <code class="docutils literal notranslate"><span class="pre">ENVIRONMENT_OPEN</span></code>.</p></li>
</ul>
</section>
<section id="console-ouput">
<span id="start-re-manager-console-output"></span><h3>Console Ouput<a class="headerlink" href="#console-ouput" title="Permalink to this heading">¶</a></h3>
<p>RE Manager captures output to <code class="docutils literal notranslate"><span class="pre">stdout</span></code> and <code class="docutils literal notranslate"><span class="pre">stderr</span></code> produced by itself and
running plans. The output may be printed to terminal and/or published to
a 0MQ socket (different socket from the socket used for control communication).</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--zmq-info-addr</span></code> allows to set the address for the 0MQ ‘PUB’ socket.</p></li>
<li><p>Setting <code class="docutils literal notranslate"><span class="pre">--zmq-publish-console</span> <span class="pre">ON</span></code> enables publishing of the collected output to
0MQ socket.</p></li>
<li><p>Setting <code class="docutils literal notranslate"><span class="pre">--console-output</span> <span class="pre">OFF</span></code> disables printing to terminal.</p></li>
</ul>
</section>
<section id="encryption-for-0mq-control-communication-channel">
<h3>Encryption for 0MQ Control Communication Channel<a class="headerlink" href="#encryption-for-0mq-control-communication-channel" title="Permalink to this heading">¶</a></h3>
<p>If the <code class="docutils literal notranslate"><span class="pre">QSERVER_ZMQ_PRIVATE_KEY_FOR_SERVER</span></code> environment variable contains a string
that represents valid private key, the enryption for control channel is enabled.
Clients must use correct public key from public/private key pair to communicate with
RE Manager. Public/private key pair can be generated using <a class="reference internal" href="#qserver-zmq-keys-cli"><span class="std std-ref">qserver-zmq-keys</span></a>.</p>
</section>
<section id="other-configuration-parameters">
<h3>Other Configuration Parameters<a class="headerlink" href="#other-configuration-parameters" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--zmq-control-addr</span></code> is the address of 0MQ socket for the server. The server is managed
by RE Manager and used to pass control commands from clients.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--redis-addr</span></code> is the address of Redis server
used by RE Manager as persistent storage.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--verbose</span></code>, <code class="docutils literal notranslate"><span class="pre">--quiet</span></code> and <code class="docutils literal notranslate"><span class="pre">--silent</span></code> options modify logging verbosity
level for RE Manager.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">start-re-manager</span> <span class="pre">-h</span></code> displays help information:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ start-re-manager -h
usage: start-re-manager [-h] [--config CONFIG_PATH] [--zmq-control-addr ZMQ_CONTROL_ADDR]
                        [--zmq-addr ZMQ_ADDR]
                        [--startup-dir STARTUP_DIR | --startup-profile PROFILE_NAME |
                         --startup-module STARTUP_MODULE_NAME | --startup-script STARTUP_SCRIPT_PATH]
                        [--existing-plans-devices EXISTING_PLANS_AND_DEVICES_PATH]
                        [--update-existing-plans-devices {NEVER,ENVIRONMENT_OPEN,ALWAYS}]
                        [--user-group-permissions USER_GROUP_PERMISSIONS_PATH]
                        [--user-group-permissions-reload {NEVER,ON_REQUEST,ON_STARTUP}]
                        [--redis-addr REDIS_ADDR] [--kafka-topic KAFKA_TOPIC]
                        [--kafka-server KAFKA_SERVER]
                        [--zmq-data-proxy-addr ZMQ_DATA_PROXY_ADDR] [--keep-re]
                        [--use-persistent-metadata]
                        [--databroker-config DATABROKER_CONFIG]
                        [--zmq-info-addr ZMQ_INFO_ADDR]
                        [--zmq-publish-console-addr ZMQ_PUBLISH_CONSOLE_ADDR]
                        [--zmq-publish-console {ON,OFF}] [--console-output {ON,OFF}]
                        [--verbose | --quiet | --silent]

Start Run Engine (RE) Manager
bluesky-queueserver version 0.0.17.post32.dev0+ga4ba9d1

Encryption for ZeroMQ communication server may be enabled by setting the value of
&#39;QSERVER_ZMQ_PRIVATE_KEY_FOR_SERVER&#39; environment variable to a valid private key
(z85-encoded 40 character string):

    export QSERVER_ZMQ_PRIVATE_KEY_FOR_SERVER=&#39;&lt;private_key&gt;&#39;

A public/private key pair may be generated by running &#39;qserver-zmq-keys&#39;. If RE Manager is
configured to use encrypted channel, the encryption must also be enabled at the client side
using the public key from the generated pair. Encryption is disabled by default.

optional arguments:
  -h, --help        show this help message and exit
  --config CONFIG_PATH
                    Path to a YML config file or a directory containing multiple config
                    files. The path passed as a parameter overrides the path set using
                    QSERVER_CONFIG environment variable. The config path must point to an
                    existing file or directory (may be empty), otherwise the manager can
                    not be started.
  --zmq-control-addr ZMQ_CONTROL_ADDR
                    The address of ZMQ server (control connection). The parameter
                    overrides the address defined by the environment variable
                    QSERVER_ZMQ_CONTROL_ADDRESS_FOR_SERVER. The default address is used if
                    the parameter or the environment variable is not defined. Address
                    format: &#39;tcp://*:60615&#39; (default: &#39;tcp://*:60615&#39;).
  --zmq-addr ZMQ_ADDR
                    The parameter is deprecated and will be removed in future releases.
                    Use --zmq-control-addr instead.
  --startup-dir STARTUP_DIR
                    Path to directory that contains a set of startup files (*.py and
                    *.ipy). All the scripts in the directory will be sorted in
                    alphabetical order of their names and loaded in the Run Engine Worker
                    environment. The set of startup files may be located in any accessible
                    directory.
  --startup-profile PROFILE_NAME
                    The name of IPython profile used to find the location of startup
                    files. Example: if IPython is configured to look for profiles in
                    &#39;~/.ipython&#39; directory (default behavior) and the profile name is
                    &#39;testing&#39;, then RE Manager will look for startup files in
                    &#39;~/.ipython/profile_testing/startup&#39; directory.
  --startup-module STARTUP_MODULE_NAME
                    The name of the module with startup code. The module is imported each
                    time the RE Worker environment is opened. Example:
                    &#39;some.startup.module&#39;. Paths to the list of existing plans and devices
                    (--existing-plans-and-devices) and user group permissions (--user-
                    group-permissions) must be explicitly specified if this option is
                    used.
  --startup-script STARTUP_SCRIPT_PATH
                    The path to the script with startup code. The script is loaded each
                    time the RE Worker environment is opened. Example:
                    &#39;~/startup/scripts/scripts.py&#39;. Paths to the list of existing plans
                    and devices (--existing-plans-and-devices) and user group permissions
                    (--user-group-permissions) must be explicitly specified if this option
                    is used.
  --existing-plans-devices EXISTING_PLANS_AND_DEVICES_PATH
                    Path to file that contains the list of existing plans and devices. The
                    path may be a relative path to the profile collection directory. If
                    the path is directory, then the default file name
                    &#39;existing_plans_and_devices.yaml&#39; is used.
  --update-existing-plans-devices {NEVER,ENVIRONMENT_OPEN,ALWAYS}
                    Select when the list of existing plans and devices stored on disk
                    should be updated. The available choices are not to update the stored
                    lists (NEVER), update the lists when the environment is opened
                    (ENVIRONMENT_OPEN) or update the lists each the lists are changed
                    (ALWAYS) (default: ENVIRONMENT_OPEN)
  --user-group-permissions USER_GROUP_PERMISSIONS_PATH
                    Path to file that contains lists of plans and devices available to
                    users. The path may be a relative path to the profile collection
                    directory. If the path is a directory, then the default file name
                    &#39;user_group_permissions.yaml&#39; is used.
  --user-group-permissions-reload {NEVER,ON_REQUEST,ON_STARTUP}
                    Select when user group permissions are reloaded from disk. Options:
                    &#39;NEVER&#39; - RE Manager never attempts to load permissions from disk
                    file. If permissions fail to load from Redis, they are loaded from
                    disk at the first startup of RE Manager or on request. &#39;ON_REQUEST&#39; -
                    permissions are loaded from disk file when requested by
                    &#39;permission_reload&#39; API call. &#39;ON_STARTUP&#39; - permissions are loaded
                    from disk each time RE Manager is started or when &#39;permission_reload&#39;
                    API request is received (default: ON_STARTUP)
  --redis-addr REDIS_ADDR
                    The address of Redis server, e.g. &#39;localhost&#39;, &#39;127.0.0.1&#39;,
                    &#39;localhost:6379&#39; (default: localhost).
  --kafka-topic KAFKA_TOPIC
                    The kafka topic to publish to.
  --kafka-server KAFKA_SERVER
                    Bootstrap server to connect (default: 127.0.0.1:9092).
  --zmq-data-proxy-addr ZMQ_DATA_PROXY_ADDR
                    The address of ZMQ proxy used to publish data. If the parameter is
                    specified, RE is subscribed to &#39;bluesky.callbacks.zmq.Publisher&#39; and
                    documents are published via 0MQ proxy. 0MQ Proxy (see Bluesky 0MQ
                    documentation) should be started before plans are executed. The
                    address should be in the form &#39;127.0.0.1:5567&#39; or &#39;localhost:5567&#39;.
                    The address is passed to &#39;bluesky.callbacks.zmq.Publisher&#39;. It is
                    recommended to use Kafka instead of 0MQ proxy in production data
                    acquisition systems and use Kafka instead.
  --keep-re         Keep RE created in profile collection. If the flag is set, RE must be
                    created in the profile collection for the plans to run. RE will also
                    keep all its subscriptions. Also must be subscribed to the Data Broker
                    inside the profile collection, since &#39;--databroker-config&#39; argument is
                    ignored.
  --use-persistent-metadata
                    Use msgpack-based persistent storage for scan metadata. Currently this
                    is the preferred method to keep continuously incremented sequence of
                    Run IDs between restarts of RE.
  --databroker-config DATABROKER_CONFIG
                    Name of the Data Broker configuration file.

Configure console output:
  The arguments allow to configure printing and publishing of the console output
  generated by RE Manager. The arguments allow to set the address of 0MQ socket
  and enable/disable printing and/or publishing of the console output.

  --zmq-info-addr ZMQ_INFO_ADDR
                    The address of ZMQ server socket used for publishing information on
                    the state of RE Manager and currently running processes. Currently
                    only the captured STDOUT and STDERR published in &#39;QS_Console&#39; topic.
                    The parameter overrides the address defined by the environment
                    variable &#39;QSERVER_ZMQ_INFO_ADDRESS_FOR_SERVER&#39;. The default address is
                    used if the parameter or the environment variable is not defined.
                    Address format: &#39;tcp://*:60625&#39; (default: tcp://*:60625).
  --zmq-publish-console-addr ZMQ_PUBLISH_CONSOLE_ADDR
                    The parameter is deprecated and will be removed in future releases.
                    Use --zmq-info-addr instead.
  --zmq-publish-console {ON,OFF}
                    Enable (ON) or disable (OFF) publishing of console output to 0MQ
                    (default: OFF).
  --console-output {ON,OFF}
                    Enable (ON) or disable (OFF) printing of console output in the Re
                    Manager terminal. (default: ON)

Logging verbosity settings:
  The default logging settings (loglevel=INFO) provide optimal amount of data to monitor
  the operation of RE Manager. Select &#39;--verbose&#39; option to see detailed data on received and
  sent messages, added and executed plans, etc. Use options &#39;--quiet&#39; and &#39;--silent&#39;
  to see only warnings and error messages or disable logging output.

  --verbose         Set logger level to DEBUG.
  --quiet           Set logger level to WARNING.
  --silent          Disables logging output.
</pre></div>
</div>
</section>
</section>
<section id="qserver">
<span id="qserver-cli"></span><h2>qserver<a class="headerlink" href="#qserver" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">qserver</span></code> CLI tool allows to communicate with the server by typing commands in command
line. The tool is primarily intended for testing or diagnostics of Queue Server and emergency use
in production. The tool supports most of the Queue Server 0MQ API including submitting plans,
opening and closing of RE Worker environment, starting and stopping the queue, etc.
Refer to <code class="docutils literal notranslate"><span class="pre">qserver</span></code> help for the full list of supported commands.</p>
<p>If RE Manager 0MQ address is different from the default, use the optional <code class="docutils literal notranslate"><span class="pre">--zmq-control-addr</span></code>
parameter or <code class="docutils literal notranslate"><span class="pre">QSERVER_ZMQ_CONTROL_ADDRESS</span></code> to pass the address to <code class="docutils literal notranslate"><span class="pre">qserver</span></code>. If encryption
is enabled at RE Manager, set the environment variable <code class="docutils literal notranslate"><span class="pre">QSERVER_ZMQ_PUBLIC_KEY</span></code> to a string
representing valid public address of the 0MQ server. Use <a class="reference internal" href="#qserver-zmq-keys-cli"><span class="std std-ref">qserver-zmq-keys</span></a> tool
to generate a new public/private key pair or generate public key from known server private key.</p>
<p><cite>qserver</cite> may used in monitoring mode (<code class="docutils literal notranslate"><span class="pre">qserver</span> <span class="pre">monitor</span></code>). In this mode the tool
periodically requests and displays the status of Queue Server.</p>
<p><code class="docutils literal notranslate"><span class="pre">qserver</span> <span class="pre">-h</span></code> displays help information:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qserver</span> <span class="o">-</span><span class="n">h</span>
<span class="n">usage</span><span class="p">:</span> <span class="n">qserver</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">zmq</span><span class="o">-</span><span class="n">control</span><span class="o">-</span><span class="n">addr</span> <span class="n">ZMQ_CONTROL_ADDR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">address</span> <span class="n">ADDRESS</span><span class="p">]</span>
              <span class="p">[</span><span class="o">--</span><span class="n">lock</span><span class="o">-</span><span class="n">key</span> <span class="n">LOCK_KEY</span><span class="p">]</span>
              <span class="n">command</span> <span class="p">[</span><span class="n">command</span> <span class="o">...</span><span class="p">]</span>

<span class="n">Command</span><span class="o">-</span><span class="n">line</span> <span class="n">tool</span> <span class="k">for</span> <span class="n">communicating</span> <span class="k">with</span> <span class="n">RE</span> <span class="n">Monitor</span><span class="o">.</span>
<span class="n">bluesky</span><span class="o">-</span><span class="n">queueserver</span> <span class="n">version</span> <span class="mf">0.0.19</span><span class="o">.</span>

<span class="n">positional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="n">command</span>           <span class="n">a</span> <span class="n">sequence</span> <span class="n">of</span> <span class="n">keywords</span> <span class="ow">and</span> <span class="n">parameters</span> <span class="n">that</span> <span class="n">define</span> <span class="n">the</span> <span class="n">command</span>

<span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>        <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">--</span><span class="n">zmq</span><span class="o">-</span><span class="n">control</span><span class="o">-</span><span class="n">addr</span> <span class="n">ZMQ_CONTROL_ADDR</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span> <span class="n">ZMQ_CONTROL_ADDR</span>
                    <span class="n">Address</span> <span class="n">of</span> <span class="n">the</span> <span class="n">control</span> <span class="n">socket</span> <span class="n">of</span> <span class="n">RE</span> <span class="n">Manager</span><span class="o">.</span> <span class="n">The</span> <span class="n">parameter</span> <span class="n">overrides</span>
                    <span class="n">the</span> <span class="n">address</span> <span class="nb">set</span> <span class="n">using</span> <span class="n">the</span> <span class="n">environment</span> <span class="n">variable</span>
                    <span class="n">QSERVER_ZMQ_CONTROL_ADDRESS</span><span class="o">.</span> <span class="n">The</span> <span class="n">default</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">used</span> <span class="k">if</span> <span class="n">the</span> <span class="n">address</span>
                    <span class="ow">is</span> <span class="ow">not</span> <span class="nb">set</span> <span class="n">using</span> <span class="n">the</span> <span class="n">parameter</span> <span class="ow">or</span> <span class="n">the</span> <span class="n">environment</span> <span class="n">variable</span><span class="o">.</span> <span class="n">Address</span>
                    <span class="nb">format</span><span class="p">:</span> <span class="s1">&#39;tcp://127.0.0.1:60615&#39;</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="s1">&#39;tcp://localhost:60615&#39;</span><span class="p">)</span><span class="o">.</span>
  <span class="o">--</span><span class="n">address</span> <span class="n">ADDRESS</span>
                    <span class="n">The</span> <span class="n">parameter</span> <span class="ow">is</span> <span class="n">deprecated</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span><span class="o">.</span> <span class="n">Use</span> <span class="o">--</span><span class="n">zmq</span><span class="o">-</span><span class="n">control</span><span class="o">-</span>
                    <span class="n">addr</span> <span class="n">instead</span><span class="o">.</span>
  <span class="o">--</span><span class="n">lock</span><span class="o">-</span><span class="n">key</span> <span class="n">LOCK_KEY</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span> <span class="n">LOCK_KEY</span>
                    <span class="n">Lock</span> <span class="n">key</span><span class="o">.</span> <span class="n">The</span> <span class="n">key</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">arbitrary</span> <span class="n">string</span> <span class="ow">is</span> <span class="n">used</span> <span class="n">to</span> <span class="n">lock</span> <span class="ow">and</span> <span class="n">unlock</span> <span class="n">RE</span>
                    <span class="n">Manager</span> <span class="p">(</span><span class="s1">&#39;lock&#39;</span> <span class="ow">and</span> <span class="s1">&#39;unlock&#39;</span> <span class="n">API</span><span class="p">)</span> <span class="ow">and</span> <span class="n">control</span> <span class="n">the</span> <span class="n">manager</span> <span class="n">when</span> <span class="n">the</span>
                    <span class="n">environment</span> <span class="ow">or</span> <span class="n">the</span> <span class="n">queue</span> <span class="ow">is</span> <span class="n">locked</span><span class="o">.</span>

<span class="n">If</span> <span class="n">RE</span> <span class="n">Manager</span> <span class="ow">is</span> <span class="n">configured</span> <span class="n">to</span> <span class="n">use</span> <span class="n">encrypted</span> <span class="n">ZeroMQ</span> <span class="n">communication</span> <span class="n">channel</span><span class="p">,</span>
<span class="n">the</span> <span class="n">encryption</span> <span class="n">must</span> <span class="n">also</span> <span class="n">be</span> <span class="n">enabled</span> <span class="n">before</span> <span class="n">running</span> <span class="s1">&#39;qserver&#39;</span> <span class="n">CLI</span> <span class="n">tool</span> <span class="n">by</span> <span class="n">setting</span>
<span class="n">the</span> <span class="n">environment</span> <span class="n">variable</span> <span class="n">QSERVER_ZMQ_PUBLIC_KEY</span> <span class="n">to</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">a</span> <span class="n">valid</span> <span class="n">public</span> <span class="n">key</span>
<span class="p">(</span><span class="n">z85</span><span class="o">-</span><span class="n">encoded</span> <span class="mi">40</span> <span class="n">character</span> <span class="n">string</span><span class="p">):</span>

    <span class="n">export</span> <span class="n">QSERVER_ZMQ_PUBLIC_KEY</span><span class="o">=</span><span class="s1">&#39;&lt;public_key&gt;&#39;</span>

<span class="n">Encryption</span> <span class="ow">is</span> <span class="n">disabled</span> <span class="n">by</span> <span class="n">default</span><span class="o">.</span>

<span class="n">Examples</span> <span class="n">of</span> <span class="n">CLI</span> <span class="n">commands</span>
<span class="o">------------------------</span>
<span class="n">qserver</span> <span class="o">-</span><span class="n">h</span>       <span class="c1"># Display help</span>
<span class="n">qserver</span> <span class="n">monitor</span>  <span class="c1"># Start &#39;qserver&#39; in monitoring mode</span>

<span class="n">qserver</span> <span class="n">ping</span>     <span class="c1"># Send &#39;ping&#39; request to RE Manager via ZMQ</span>
<span class="n">qserver</span> <span class="n">status</span>   <span class="c1"># Request status of RE Manager</span>

<span class="n">qserver</span> <span class="n">config</span>   <span class="c1"># Get RE Manager config</span>

<span class="n">qserver</span> <span class="n">environment</span> <span class="nb">open</span>         <span class="c1"># Open RE environment</span>
<span class="n">qserver</span> <span class="n">environment</span> <span class="n">close</span>        <span class="c1"># Close RE environment</span>
<span class="n">qserver</span> <span class="n">environment</span> <span class="n">destroy</span>      <span class="c1"># Destroy RE environment (kill RE worker process)</span>

<span class="n">qserver</span> <span class="n">existing</span> <span class="n">plans</span>           <span class="c1"># Request the list of existing plans</span>
<span class="n">qserver</span> <span class="n">existing</span> <span class="n">devices</span>         <span class="c1"># Request the list of existing devices</span>
<span class="n">qserver</span> <span class="n">allowed</span> <span class="n">plans</span>            <span class="c1"># Request the list of allowed plans</span>
<span class="n">qserver</span> <span class="n">allowed</span> <span class="n">devices</span>          <span class="c1"># Request the list of allowed devices</span>
<span class="n">qserver</span> <span class="n">permissions</span> <span class="n">reload</span>       <span class="c1"># Reload user permissions and generate lists of allowed plans and devices.</span>
<span class="n">qserver</span> <span class="n">permissions</span> <span class="n">reload</span> <span class="n">lists</span> <span class="c1"># Same, but reload lists of existing plans and devices from disk.</span>

<span class="n">qserver</span> <span class="n">permissions</span> <span class="nb">set</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>  <span class="c1"># Set user group permissions (from .yaml file)</span>
<span class="n">qserver</span> <span class="n">permissions</span> <span class="n">get</span>                 <span class="c1"># Get current user group permissions</span>

<span class="n">qserver</span> <span class="n">queue</span> <span class="n">add</span> <span class="n">plan</span> <span class="s1">&#39;&lt;plan-params&gt;&#39;</span>                 <span class="c1"># Add plan to the back of the queue</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">add</span> <span class="n">instruction</span> <span class="o">&lt;</span><span class="n">instruction</span><span class="o">&gt;</span>            <span class="c1"># Add instruction to the back of the queue</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">add</span> <span class="n">plan</span> <span class="n">front</span> <span class="s1">&#39;&lt;plan-params&gt;&#39;</span>           <span class="c1"># Add plan to the front of the queue</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">add</span> <span class="n">plan</span> <span class="n">back</span> <span class="s1">&#39;&lt;plan-params&gt;&#39;</span>            <span class="c1"># Add plan to the back of the queue</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">add</span> <span class="n">plan</span> <span class="mi">2</span> <span class="s1">&#39;&lt;plan-params&gt;&#39;</span>               <span class="c1"># Insert plan at position 2</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">add</span> <span class="n">instruction</span> <span class="mi">2</span> <span class="o">&lt;</span><span class="n">instruction</span><span class="o">&gt;</span>          <span class="c1"># Insert instruction at position 2</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">add</span> <span class="n">plan</span> <span class="o">-</span><span class="mi">1</span> <span class="s1">&#39;&lt;plan-params&gt;&#39;</span>              <span class="c1"># Insert plan at position -1</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">add</span> <span class="n">plan</span> <span class="n">before</span> <span class="s1">&#39;&lt;uid&gt;&#39;</span> <span class="s1">&#39;&lt;plan-params&gt;&#39;</span>  <span class="c1"># Insert the plan before the plan with given UID</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">add</span> <span class="n">plan</span> <span class="n">after</span> <span class="s1">&#39;&lt;uid&gt;&#39;</span> <span class="s1">&#39;&lt;plan-params&gt;&#39;</span>   <span class="c1"># Insert the plan after the plan with given UID</span>
<span class="n">NOTE</span><span class="p">:</span> <span class="n">Position</span> <span class="n">indices</span> <span class="n">are</span> <span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="o">.</span> <span class="n">Inserting</span> <span class="n">a</span> <span class="n">plan</span> <span class="n">to</span> <span class="n">position</span> <span class="mi">0</span> <span class="n">pushes</span> <span class="n">it</span> <span class="n">to</span> <span class="n">the</span> <span class="n">front</span> <span class="n">of</span> <span class="n">the</span> <span class="n">queue</span><span class="o">.</span>
      <span class="n">Negative</span> <span class="n">position</span> <span class="n">indices</span> <span class="n">are</span> <span class="n">counted</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">back</span> <span class="n">of</span> <span class="n">the</span> <span class="n">queue</span><span class="o">.</span> <span class="n">Request</span> <span class="k">for</span> <span class="n">a</span> <span class="n">plan</span> <span class="k">with</span> <span class="n">index</span> <span class="o">-</span><span class="mi">1</span>
      <span class="n">returns</span> <span class="n">the</span> <span class="n">last</span> <span class="n">plan</span> <span class="n">of</span> <span class="n">the</span> <span class="n">queue</span><span class="o">.</span> <span class="n">Inserting</span> <span class="n">a</span> <span class="n">plan</span> <span class="n">at</span> <span class="n">position</span> <span class="o">-</span><span class="mi">1</span> <span class="n">makes</span> <span class="n">it</span> <span class="n">previous</span> <span class="n">to</span> <span class="n">last</span><span class="o">.</span>

<span class="n">qserver</span> <span class="n">queue</span> <span class="n">update</span> <span class="n">plan</span> <span class="o">&lt;</span><span class="n">uid</span><span class="o">&gt;</span> <span class="s1">&#39;&lt;plan-params&gt;&#39;</span>         <span class="c1">#  Update item with &lt;uid&gt; with a plan</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">replace</span> <span class="n">plan</span> <span class="o">&lt;</span><span class="n">uid</span><span class="o">&gt;</span> <span class="s1">&#39;&lt;plan-params&gt;&#39;</span>        <span class="c1">#  Replace item with &lt;uid&gt; with a plan</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">update</span> <span class="n">instruction</span> <span class="o">&lt;</span><span class="n">uid</span><span class="o">&gt;</span> <span class="s1">&#39;&lt;instruction&gt;&#39;</span>  <span class="c1">#  Update item with &lt;uid&gt; with an instruction</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">replace</span> <span class="n">instruction</span> <span class="o">&lt;</span><span class="n">uid</span><span class="o">&gt;</span> <span class="s1">&#39;&lt;instruction&gt;&#39;</span> <span class="c1">#  Replace item with &lt;uid&gt; with an instruction</span>

<span class="n">qserver</span> <span class="n">queue</span> <span class="n">execute</span> <span class="n">plan</span> <span class="s1">&#39;&lt;plan-params&gt;&#39;</span>              <span class="c1"># Immediately execute the plan</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">execute</span> <span class="n">instruction</span> <span class="o">&lt;</span><span class="n">instruction</span><span class="o">&gt;</span>         <span class="c1"># Immediately execute an instruction</span>

<span class="n">Example</span> <span class="n">of</span> <span class="n">JSON</span> <span class="n">specification</span> <span class="n">of</span> <span class="n">a</span> <span class="n">plan</span><span class="p">:</span>
    <span class="s1">&#39;{&quot;name&quot;: &quot;count&quot;, &quot;args&quot;: [[&quot;det1&quot;, &quot;det2&quot;]], &quot;kwargs&quot;: {&quot;num&quot;: 10, &quot;delay&quot;: 1}}&#39;</span>

<span class="n">Supported</span> <span class="n">queue</span> <span class="n">instructions</span><span class="p">:</span>
    <span class="n">queue</span><span class="o">-</span><span class="n">stop</span>  <span class="c1"># stops execution of the queue</span>

<span class="n">qserver</span> <span class="n">queue</span> <span class="n">get</span>    <span class="c1"># Request the list of items (plans or instructions) in the queue</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">clear</span>  <span class="c1"># Clear the queue (remove all plans from the queue)</span>

<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">get</span>           <span class="c1"># Request the last item in the queue</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">get</span> <span class="n">back</span>      <span class="c1"># Request the last item in the queue</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">get</span> <span class="n">front</span>     <span class="c1"># Request the first item in the queue</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">get</span> <span class="mi">2</span>         <span class="c1"># Request the item at position 2</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">get</span> <span class="s1">&#39;&lt;uid&gt;&#39;</span>   <span class="c1"># Request the item with given Item UID</span>

<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">remove</span>          <span class="c1"># Remove the last item from the queue</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">remove</span> <span class="n">back</span>     <span class="c1"># Remove the last item from the queue</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">remove</span> <span class="n">front</span>    <span class="c1"># Remove the first item from the queue</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">remove</span> <span class="mi">2</span>        <span class="c1"># Remove the item at position 2</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">remove</span> <span class="s1">&#39;&lt;uid&gt;&#39;</span>  <span class="c1"># Remove the item with the given UID</span>

<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">move</span> <span class="mi">2</span> <span class="mi">5</span>                             <span class="c1"># Move item from position 2 to position 5 of the queue</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">move</span> <span class="n">back</span> <span class="n">front</span>                      <span class="c1"># Move item from the back to the front of the queue</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">move</span> <span class="n">front</span> <span class="o">-</span><span class="mi">2</span>                        <span class="c1"># Move item from the front of the queue to position -2</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">move</span> <span class="s1">&#39;&lt;uid-src&gt;&#39;</span> <span class="mi">5</span>                   <span class="c1"># Move item with UID &lt;uid-src&gt; to position 5</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">move</span> <span class="mi">2</span> <span class="n">before</span> <span class="s1">&#39;&lt;uid-dest&gt;&#39;</span>           <span class="c1"># Place item at position 2 before an item with &lt;uid-dest&gt;</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">move</span> <span class="mi">2</span> <span class="n">after</span> <span class="s1">&#39;&lt;uid-dest&gt;&#39;</span>            <span class="c1"># Place item at position 2 after an item with &lt;uid-dest&gt;</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">item</span> <span class="n">move</span> <span class="s1">&#39;&lt;uid-src&gt;&#39;</span> <span class="n">before</span> <span class="s1">&#39;&lt;uid-dest&gt;&#39;</span> <span class="c1"># Place item with &lt;uid-src&gt; before item with &lt;uid-dest&gt;</span>

<span class="n">qserver</span> <span class="n">queue</span> <span class="n">start</span>        <span class="c1"># Start execution of the queue</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">stop</span>         <span class="c1"># Request execition of the queue to stop after current plan</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">stop</span> <span class="n">cancel</span>  <span class="c1"># Cancel request to stop execution of the queue</span>

<span class="c1"># Enable and disable autostart</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">autostart</span> <span class="n">enable</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">autostart</span> <span class="n">disable</span>

<span class="c1"># Change the queue mode. Enable/disable LOOP and IGNORE_FAILURES modes:</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">mode</span> <span class="nb">set</span> <span class="n">loop</span> <span class="kc">True</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">mode</span> <span class="nb">set</span> <span class="n">loop</span> <span class="kc">False</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">mode</span> <span class="nb">set</span> <span class="n">ignore_failures</span> <span class="kc">True</span>
<span class="n">qserver</span> <span class="n">queue</span> <span class="n">mode</span> <span class="nb">set</span> <span class="n">ignore_failures</span> <span class="kc">False</span>

<span class="c1"># The following requests are forwarded to the Run Engine:</span>
<span class="n">qserver</span> <span class="n">re</span> <span class="n">pause</span>           <span class="c1"># Request to PAUSE currently executed plan at the next checkpoint</span>
<span class="n">qserver</span> <span class="n">re</span> <span class="n">pause</span> <span class="n">deferred</span>  <span class="c1"># Request to PAUSE currently executed plan at the next checkpoint</span>
<span class="n">qserver</span> <span class="n">re</span> <span class="n">pause</span> <span class="n">immediate</span> <span class="c1"># Request to immediately PAUSE currently executed plan</span>
<span class="n">qserver</span> <span class="n">re</span> <span class="n">resume</span>          <span class="c1"># RESUME execution of a paused plan</span>
<span class="n">qserver</span> <span class="n">re</span> <span class="n">stop</span>            <span class="c1"># STOP execution of a paused plan</span>
<span class="n">qserver</span> <span class="n">re</span> <span class="n">abort</span>           <span class="c1"># ABORT execution of a paused plan</span>
<span class="n">qserver</span> <span class="n">re</span> <span class="n">halt</span>            <span class="c1"># HALT execution of a paused plan</span>

<span class="n">qserver</span> <span class="n">re</span> <span class="n">runs</span>            <span class="c1"># Get the list of active runs (runs generated by the currently running plans)</span>
<span class="n">qserver</span> <span class="n">re</span> <span class="n">runs</span> <span class="n">active</span>     <span class="c1"># Get the list of active runs</span>
<span class="n">qserver</span> <span class="n">re</span> <span class="n">runs</span> <span class="nb">open</span>       <span class="c1"># Get the list of open runs (subset of active runs)</span>
<span class="n">qserver</span> <span class="n">re</span> <span class="n">runs</span> <span class="n">closed</span>     <span class="c1"># Get the list of closed runs (subset of active runs)</span>

<span class="n">qserver</span> <span class="n">history</span> <span class="n">get</span>        <span class="c1"># Request plan history</span>
<span class="n">qserver</span> <span class="n">history</span> <span class="n">clear</span>      <span class="c1"># Clear plan history</span>

<span class="n">qserver</span> <span class="n">function</span> <span class="n">execute</span> <span class="o">&lt;</span><span class="n">function</span><span class="o">-</span><span class="n">params</span><span class="o">&gt;</span>             <span class="c1"># Start execution of a function</span>
<span class="n">qserver</span> <span class="n">function</span> <span class="n">execute</span> <span class="o">&lt;</span><span class="n">function</span><span class="o">-</span><span class="n">params</span><span class="o">&gt;</span> <span class="n">background</span>  <span class="c1"># ... in the background thread</span>

<span class="n">Example</span> <span class="n">of</span> <span class="n">JSON</span> <span class="n">specification</span> <span class="n">of</span> <span class="n">a</span> <span class="n">function</span> <span class="p">(</span><span class="s2">&quot;args&quot;</span> <span class="ow">and</span> <span class="s2">&quot;kwargs&quot;</span> <span class="n">are</span> <span class="n">optional</span><span class="p">):</span>
    <span class="s1">&#39;{&quot;name&quot;: &quot;function_sleep&quot;, &quot;args&quot;: [20], &quot;kwargs&quot;: </span><span class="si">{}</span><span class="s1">}&#39;</span>

<span class="n">qserver</span> <span class="n">script</span> <span class="n">upload</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>              <span class="c1"># Upload a script to RE Worker environment</span>
<span class="n">qserver</span> <span class="n">script</span> <span class="n">upload</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span> <span class="n">background</span>   <span class="c1"># ... in the background</span>
<span class="n">qserver</span> <span class="n">script</span> <span class="n">upload</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span> <span class="n">update</span><span class="o">-</span><span class="n">re</span>    <span class="c1"># ... allow &#39;RE&#39; and &#39;db&#39; to be updated</span>
<span class="n">qserver</span> <span class="n">script</span> <span class="n">upload</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span> <span class="n">keep</span><span class="o">-</span><span class="n">lists</span>   <span class="c1"># ... leave lists of allowed and existing plans and devices</span>
                                                  <span class="c1">#   unchanged (saves processing time)</span>

<span class="n">qserver</span> <span class="n">task</span> <span class="n">result</span> <span class="o">&lt;</span><span class="n">task</span><span class="o">-</span><span class="n">uid</span><span class="o">&gt;</span>  <span class="c1"># Load status or result of a task with the given UID</span>
<span class="n">qserver</span> <span class="n">task</span> <span class="n">status</span> <span class="o">&lt;</span><span class="n">task</span><span class="o">-</span><span class="n">uid</span><span class="o">&gt;</span>  <span class="c1"># Check status of a task with the given UID</span>

<span class="n">qserver</span> <span class="n">lock</span> <span class="n">environment</span>  <span class="o">-</span><span class="n">k</span> <span class="mi">90</span><span class="n">g94</span>                   <span class="c1"># Lock the environment</span>
<span class="n">qserver</span> <span class="n">lock</span> <span class="n">environment</span> <span class="s2">&quot;Locked for 1 hr&quot;</span> <span class="o">-</span><span class="n">k</span> <span class="mi">90</span><span class="n">g94</span>  <span class="c1"># Add a text note</span>
<span class="n">qserver</span> <span class="n">lock</span> <span class="n">queue</span> <span class="o">-</span><span class="n">k</span> <span class="mi">90</span><span class="n">g94</span>                          <span class="c1"># Lock the queue</span>
<span class="n">qserver</span> <span class="n">lock</span> <span class="nb">all</span> <span class="o">-</span><span class="n">k</span> <span class="mi">90</span><span class="n">g94</span>                            <span class="c1"># Lock environment and the queue</span>

<span class="n">qserver</span> <span class="n">lock</span> <span class="n">info</span>                        <span class="c1"># Load lock status</span>
<span class="n">qserver</span> <span class="n">lock</span> <span class="n">info</span> <span class="o">-</span><span class="n">k</span> <span class="mi">90</span><span class="n">g94</span>               <span class="c1"># Load lock status and validate the key</span>

<span class="n">qserver</span> <span class="n">unlock</span> <span class="o">-</span><span class="n">k</span> <span class="mi">90</span><span class="n">g94</span>                  <span class="c1"># Unlock RE Manager</span>

<span class="n">qserver</span> <span class="n">manager</span> <span class="n">stop</span>           <span class="c1"># Safely exit RE Manager application</span>
<span class="n">qserver</span> <span class="n">manager</span> <span class="n">stop</span> <span class="n">safe</span> <span class="n">on</span>   <span class="c1"># Safely exit RE Manager application</span>
<span class="n">qserver</span> <span class="n">manager</span> <span class="n">stop</span> <span class="n">safe</span> <span class="n">off</span>  <span class="c1"># Force RE Manager application to stop</span>
<span class="n">NOTE</span><span class="p">:</span> <span class="n">Exit</span> <span class="k">with</span> <span class="s1">&#39;safe on&#39;</span> <span class="n">option</span> <span class="n">will</span> <span class="n">succeed</span> <span class="n">only</span> <span class="k">if</span> <span class="n">RE</span> <span class="n">Manager</span> <span class="ow">is</span> <span class="ow">in</span> <span class="n">IDLE</span> <span class="n">state</span> <span class="p">(</span><span class="n">queue</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">running</span><span class="p">)</span><span class="o">.</span>
<span class="n">If</span> <span class="n">called</span> <span class="k">with</span> <span class="s1">&#39;safe off&#39;</span> <span class="n">option</span><span class="p">,</span> <span class="n">the</span> <span class="n">request</span> <span class="n">will</span> <span class="n">force</span> <span class="n">RE</span> <span class="n">Manager</span> <span class="n">to</span> <span class="n">terminate</span> <span class="n">RE</span> <span class="n">Worker</span> <span class="n">process</span> <span class="ow">and</span>
<span class="n">exit</span> <span class="n">even</span> <span class="k">if</span> <span class="n">a</span> <span class="n">plan</span> <span class="ow">is</span> <span class="n">running</span><span class="o">.</span>

<span class="n">qserver</span> <span class="n">manager</span> <span class="n">kill</span> <span class="n">test</span>  <span class="c1"># Kills RE Manager by stopping asyncio event loop. Used only for testing.</span>
</pre></div>
</div>
</section>
<section id="qserver-list-plans-devices">
<span id="qserver-list-plans-devices-cli"></span><h2>qserver-list-plans-devices<a class="headerlink" href="#qserver-list-plans-devices" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">qserver-list-plans-devices</span></code> loads the startup code and generates the lists of existing plans and devices.
The tool may be used for the following purposes:</p>
<ul class="simple">
<li><p>Validation of startup code. If startup code is successfully loaded by <code class="docutils literal notranslate"><span class="pre">qserver-list-plans-devices</span></code>
it is very likely that it will be successfully loaded into the RE Worker environment.</p></li>
<li><p>Generation of the list of existing plans and devices (<code class="docutils literal notranslate"><span class="pre">existing_plans_and_devices.yaml</span></code>). Queue Server
may be configured to automatically generate or update the file (see <a class="reference internal" href="#update-existing-plans-devices"><span class="std std-ref">Updating the List of Existing Plans and Devices</span></a>),
but sometimes it may be more convenient to do it manually or as part of the installation script.</p></li>
</ul>
<p>The lists of existing plans and devices must be updated each time new devices or plans are added to or
removed from the startup code or signatures of the existing plans are modified (e.g. a parameter is added
or removed, type annotation or text description is changed etc.), since those changes may affect other
functionality such as plan validation or lists of allowed plans and devices distributed to clients.</p>
<p>The default name for the output file is <code class="docutils literal notranslate"><span class="pre">existing_plans_and_devices.yaml</span></code>. The file is always
saved to the current directory unless a different path is specified using the <code class="docutils literal notranslate"><span class="pre">--file-dir</span></code>
parameter. If the output file must have name different from the default, the new name
can be specified using the <code class="docutils literal notranslate"><span class="pre">--file-name</span></code> parameter.</p>
<p>The tool may load startup code from IPython startup script collection, Python script or Python module.
Use <code class="docutils literal notranslate"><span class="pre">--startup-dir</span></code>, <code class="docutils literal notranslate"><span class="pre">--startup-script</span></code> and <code class="docutils literal notranslate"><span class="pre">--startup-module</span></code> parameters to specify
the path to the directory with startup files, the path to a startup script or module name respectively.</p>
<p><code class="docutils literal notranslate"><span class="pre">qserver-list-plans-devices</span> <span class="pre">-h</span></code> displays help information:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ qserver-list-plans-devices -h
usage: qserver-list-plans-devices [-h] [--file-dir FILE_DIR] [--file-name FILE_NAME]
                                  [--startup-dir STARTUP_DIR | --startup-module STARTUP_MODULE_NAME | --startup-script STARTUP_SCRIPT_PATH]

Bluesky-QServer:
CLI tool for generating the list of plans and devices from beamline startup scripts.
bluesky-queueserver version 0.0.3.post61.dev0+g45f1afb

optional arguments:
  -h, --help        show this help message and exit
  --file-dir FILE_DIR
                    Directory name where the list of plans and devices is saved. By
                    default, the list is saved to the file
                    &#39;existing_plans_and_devices.yaml&#39; in the current directory.
  --file-name FILE_NAME
                    Name of the file where the list of plans and devices is saved. Default
                    file name: &#39;existing_plans_and_devices.yaml&#39;.
  --startup-dir STARTUP_DIR
                    Path to directory that contains a set of startup files (*.py and
                    *.ipy). All the scripts in the directory will be sorted in
                    alphabetical order of their names and loaded in the Run Engine Worker
                    environment. The set of startup files may be located in any accessible
                    directory. For example, &#39;qserver-list-plans-devices --startup-dir .&#39;
                    loads startup files from the current directory and saves the lists to
                    the file in current directory.
  --startup-module STARTUP_MODULE_NAME
                    The name of the module that contains the startup code. The module must
                    be installed in the current environment For example, &#39;qserver-list-
                    plans-devices --startup-module some.startup.module&#39; loads startup code
                    from the module &#39;some.startup.module&#39; and saves results to the file in
                    the current directory.
  --startup-script STARTUP_SCRIPT_PATH
                    The path to the script with startup code. For example, &#39;qserver-list-
                    plans-devices --startup-script ~/startup/scripts/script.py&#39; loads
                    startup code from the script and saves the results to the file in the
                    current directory.
</pre></div>
</div>
</section>
<section id="qserver-zmq-keys">
<span id="qserver-zmq-keys-cli"></span><h2>qserver-zmq-keys<a class="headerlink" href="#qserver-zmq-keys" title="Permalink to this heading">¶</a></h2>
<p>Use this tool to generate random public-private key pairs for securing 0MQ control communication
channel used by RE Manager:</p>
<ul class="simple">
<li><p><strong>private key</strong> - set as a value of <code class="docutils literal notranslate"><span class="pre">QSERVER_ZMQ_PRIVATE_KEY_FOR_SERVER</span></code> environment variable
at workstation or server running RE Manager</p></li>
<li><p><strong>public key</strong> - set as a value of <code class="docutils literal notranslate"><span class="pre">QSERVER_ZMQ_PUBLIC_KEY</span></code> environment variable at
the workstation(s) running the client application(s).</p></li>
</ul>
<p>If server private key is know, the public key may be generated by passing the private
key to <code class="docutils literal notranslate"><span class="pre">qserver-zmq-keys</span></code> using <code class="docutils literal notranslate"><span class="pre">--zmq-private_key</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">qserver-zmq-keys</span> <span class="pre">-h</span></code> displays help information:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ qserver-zmq-keys -h
usage: qserver-zmq-keys [-h] [--zmq-private-key ZMQ_PRIVATE_KEY]

Bluesky-QServer:
ZMQ security: Generate public-private key pair for ZeroMQ control communication channel.
bluesky-queueserver version 0.0.3.post61.dev0+g45f1afb.

Generate new public-private key pair for secured 0MQ control connection between
RE Manager and client applications. If private key is passed as ``--zmq-private-key``
parameter, then the generated key pair is based on the provided private key.

optional arguments:
  -h, --help        show this help message and exit
  --zmq-private-key ZMQ_PRIVATE_KEY
                    Private key used by RE Manager. If the private key is provided, then
                    the public key is generated based on the private key. This option
                    allows to create (recover) public key based on known private key. The
                    passed value should be 40 character string containing z85 encrypted
                    key.
</pre></div>
</div>
</section>
<section id="qserver-console-monitor">
<span id="qserver-console-monitor-cli"></span><h2>qserver-console-monitor<a class="headerlink" href="#qserver-console-monitor" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">qserver-console-monitor</span></code> is a simple application that subscribes to the console output (<code class="docutils literal notranslate"><span class="pre">stdout</span></code> and
<code class="docutils literal notranslate"><span class="pre">stderr</span></code>) published by RE Manager via 0MQ and prints the received messages to terminal (to <code class="docutils literal notranslate"><span class="pre">stdout</span></code>).
The console output printed by the monitor is expected to be identical to the output printed in
RE Manager terminal. The monitor may be run on the same workstation as RE Manager or any computer,
which can access the workstation running RE Manager over the network. If the address of
the 0MQ socket is different from default, it can be passed to the monitor application
as a parameter (<code class="docutils literal notranslate"><span class="pre">--zmq-info-addr</span></code>). RE Manager does not publishing the console output
to 0MQ socket by default. Publishing can be enabled by starting RE Manager with the parameter
<code class="docutils literal notranslate"><span class="pre">--zmq-publish-console</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">start</span><span class="o">-</span><span class="n">re</span><span class="o">-</span><span class="n">manager</span> <span class="o">--</span><span class="n">zmq</span><span class="o">-</span><span class="n">publish</span><span class="o">-</span><span class="n">console</span> <span class="n">ON</span>
</pre></div>
</div>
<p>(see <a class="reference internal" href="#start-re-manager-console-output"><span class="std std-ref">Console Ouput</span></a>).</p>
<p><code class="docutils literal notranslate"><span class="pre">qserver-console-monitor</span> <span class="pre">-h</span></code> displays help information:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ qserver-console-monitor -h
usage: qserver-console-monitor [-h] [--zmq-info-addr ZMQ_INFO_ADDR]
                              [--zmq-subscribe-addr ZMQ_SUBSCRIBE_ADDR]

Queue Server Console Monitor:
CLI tool for remote monitoring of console output published by RE Manager.
bluesky-queueserver version 0.0.15

optional arguments:
  -h, --help        show this help message and exit
  --zmq-info-addr ZMQ_INFO_ADDR
                    The address of RE Manager socket used for publishing console output.
                    The parameter overrides the address set using QSERVER_ZMQ_INFO_ADDRESS
                    environment variable. The default value is used if the address is not
                    set using the parameter or the environment variable. Address format:
                    &#39;tcp://127.0.0.1:60625&#39; (default: tcp://localhost:60625).
  --zmq-subscribe-addr ZMQ_SUBSCRIBE_ADDR
                    The parameter is deprecated and will be removed. Use --zmq-info-addr
                    instead.
</pre></div>
</div>
</section>
<section id="qserver-clear-lock">
<span id="qserver-clear-lock-cli"></span><h2>qserver-clear-lock<a class="headerlink" href="#qserver-clear-lock" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">qserver-clear-lock</span></code> allows to clear RE Manager lock stored in Redis. The manager lock
is not cleared by restarting the manager: it must be explicitly cleared using
a valid lock key (used to lock the manager) or an emergency lock key (optional).
If the key is lost and the emergency lock key is not set or known, then the lock
could be cleared by running <code class="docutils literal notranslate"><span class="pre">qserver-clear-lock</span></code> and restarting RE Manager application
or service. The utility needs access to Redis server used by RE Manager. If Redis
address is different from default, the correct address must be passed using the parameter
<code class="docutils literal notranslate"><span class="pre">--redis-addr</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ qserver-clear-lock -h
usage: qserver-clear-lock [-h] [--redis-addr REDIS_ADDR]

Bluesky-QServer: Clear RE Manager lock.
bluesky-queueserver version 0.0.16.

Recover locked RE Manager if the lock key is lost. The utility requires access to Redis
used by RE Manager. Provide the address of Redis service using &#39;--redis-addr&#39; parameter.
Restart the RE Manager service after clearing the lock.

optional arguments:
  -h, --help        show this help message and exit
  --redis-addr REDIS_ADDR
                    The address of Redis server, e.g. &#39;localhost&#39;, &#39;127.0.0.1&#39;,
                    &#39;localhost:6379&#39; (default: localhost).
</pre></div>
</div>
</section>
<section id="qserver-console">
<span id="qserver-console-cli"></span><h2>qserver-console<a class="headerlink" href="#qserver-console" title="Permalink to this heading">¶</a></h2>
<p>Starts Jupyter Console connected to IPython kernel running in the worker process.
RE Manager must be started with enabled <code class="docutils literal notranslate"><span class="pre">--use-ipython-kernel</span></code> option (using CLI
parameter, config file parameter or the environment variable). The console can not
be started if the worker environment is closed and the kernel is not running.
Use <code class="docutils literal notranslate"><span class="pre">Ctrl-D</span></code> to exit the console. Typing <code class="docutils literal notranslate"><span class="pre">quit</span></code> or <code class="docutils literal notranslate"><span class="pre">exit</span></code> in the console will
close the worker environment.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ qserver-console -h
usage: qserver-console [-h] [--zmq-control-addr ZMQ_CONTROL_ADDR]

Bluesky-QServer: Start Jupyter console for IPython kernel running in the worker process.
bluesky-queueserver version 0.0.18.post117.dev0+ged01cde.

Requests IPython kernel connection info from RE Manager and starts Jupyter Console. The RE Worker
must be running (environment opened) and using IPython kernel. The address of 0MQ control port of
RE Manager can be passed as a parameter or an environment variable. If encryption of the control
channel is enabled, the public key can be passed by setting QSERVER_ZMQ_PUBLIC_KEY environment
variable. Use &#39;Ctrl-D&#39; to exit the console. Typing &#39;quit&#39; or &#39;exit&#39; in the console will close
the worker environment.

options:
  -h, --help        show this help message and exit
  --zmq-control-addr ZMQ_CONTROL_ADDR, -a ZMQ_CONTROL_ADDR
                    Address of the control socket of RE Manager. The parameter overrides
                    the address set using the environment variable
                    QSERVER_ZMQ_CONTROL_ADDRESS. The default value is used if the address
                    is not set using the parameter or the environment variable. Address
                    format: &#39;tcp://127.0.0.1:60615&#39; (default: &#39;tcp://localhost:60615&#39;).
</pre></div>
</div>
</section>
<section id="qserver-qtconsole">
<span id="qserver-qtconsole-cli"></span><h2>qserver-qtconsole<a class="headerlink" href="#qserver-qtconsole" title="Permalink to this heading">¶</a></h2>
<p>Starts Jupyter Qt Console connected to the IPython kernel running in the worker process.
Jupyter Qt Console is extended Qt-based version of Jupyter Console. The command behaves similarly
to <a class="reference internal" href="#qserver-console-cli"><span class="std std-ref">qserver-console</span></a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="generated/bluesky_queueserver.parameter_annotation_decorator.html" class="btn btn-neutral float-left" title="bluesky_queueserver.parameter_annotation_decorator" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="manager_config.html" class="btn btn-neutral float-right" title="RE Manager Configuration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2021, Brookhaven National Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>