

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contributing &mdash; bluesky-queueserver 0.0.21.post7+gb5fc78e documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="_static/theme_overrides.css?v=0c24fe83" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5afba0ad"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Introduction" href="introduction_for_users.html" />
    <link rel="prev" title="Release History" href="release_history.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            bluesky-queueserver
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_history.html">Release History</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-notes">General Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#getting-started">Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="#making-changes">Making Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#writing-the-commit-message">Writing the commit message</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-pull-request">The Pull Request</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#installation-of-the-queue-server-for-development">Installation of the Queue Server for Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-pre-commit">Setting up <cite>pre-commit</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-unit-tests-locally">Running Unit Tests Locally</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-unit-tests-on-github">Running Unit Tests on GitHub</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/bluesky/bluesky-queueserver">Source Code on GitHub</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User's Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction_for_users.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_queue_server.html">Using the Queue Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="features_and_config.html">Features and Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="startup_code.html">Organizing Bluesky Startup Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="item_validation.html">Validation of Queue Items</a></li>
<li class="toctree-l1"><a class="reference internal" href="plan_annotation.html">Annotating Bluesky Plans</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli_tools.html">Command-Line Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="manager_config.html">RE Manager Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="qserver_quick_ref.html"><em>qserver</em> : Quick Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Application Developer's Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="interacting_with_qs.html">Interacting with Queue Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="re_manager_api.html">Run Engine Manager API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Related Projects</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/bluesky-queueserver-api">Bluesky Queue Server API</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/bluesky-httpserver">Bluesky HTTP Server</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/bluesky-widgets">Bluesky Widgets</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/bluesky">Bluesky</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/ophyd">Ophyd</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/databroker">Data Broker</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">bluesky-queueserver</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Contributing</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/contributing.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="contributing">
<h1>Contributing<a class="headerlink" href="#contributing" title="Link to this heading"></a></h1>
<section id="general-notes">
<h2>General Notes<a class="headerlink" href="#general-notes" title="Link to this heading"></a></h2>
<section id="getting-started">
<h3>Getting Started<a class="headerlink" href="#getting-started" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Make sure you have a <a class="reference external" href="https://github.com/signup">GitHub account</a>.</p></li>
<li><p>Submit a ticket for your issue, assuming one does not already exist.</p>
<ul>
<li><p>Clearly describe the issue including steps to reproduce when it is a bug.</p></li>
<li><p>Make sure you fill in the earliest version that you know has the issue.</p></li>
</ul>
</li>
<li><p>Fork the repository on GitHub</p></li>
</ul>
</section>
<section id="making-changes">
<h3>Making Changes<a class="headerlink" href="#making-changes" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Create a topic branch from where you want to base your work.</p>
<ul>
<li><p>This is usually the <cite>main</cite> branch.</p></li>
<li><p>Only target release branches if you are certain your fix must be on that
branch.</p></li>
<li><p>To quickly create a topic branch based on <cite>main</cite>; <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">-b</span>
<span class="pre">my_branch_name</span> <span class="pre">main</span></code>. Please avoid working directly on the
<cite>main</cite> branch.</p></li>
</ul>
</li>
<li><p>Make commits of logical units.</p></li>
<li><p>Check for unnecessary whitespace with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span> <span class="pre">--check</span></code> before committing.</p></li>
<li><p>Make sure your commit messages are in the proper format (see below)</p></li>
<li><p>Make sure you have added the necessary tests for your changes.</p></li>
<li><p>Run <em>all</em> the tests to assure nothing else was accidentally broken.</p></li>
</ul>
</section>
<section id="writing-the-commit-message">
<h3>Writing the commit message<a class="headerlink" href="#writing-the-commit-message" title="Link to this heading"></a></h3>
<p>Commit messages should be clear and follow a few basic rules. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ENH</span><span class="p">:</span> <span class="n">add</span> <span class="n">functionality</span> <span class="n">X</span> <span class="n">to</span> <span class="n">bluesky</span><span class="o">.&lt;</span><span class="n">submodule</span><span class="o">&gt;.</span>

<span class="n">The</span> <span class="n">first</span> <span class="n">line</span> <span class="n">of</span> <span class="n">the</span> <span class="n">commit</span> <span class="n">message</span> <span class="n">starts</span> <span class="k">with</span> <span class="n">a</span> <span class="n">capitalized</span> <span class="n">acronym</span>
<span class="p">(</span><span class="n">options</span> <span class="n">listed</span> <span class="n">below</span><span class="p">)</span> <span class="n">indicating</span> <span class="n">what</span> <span class="nb">type</span> <span class="n">of</span> <span class="n">commit</span> <span class="n">this</span> <span class="ow">is</span><span class="o">.</span>  <span class="n">Then</span> <span class="n">a</span> <span class="n">blank</span>
<span class="n">line</span><span class="p">,</span> <span class="n">then</span> <span class="n">more</span> <span class="n">text</span> <span class="k">if</span> <span class="n">needed</span><span class="o">.</span>  <span class="n">Lines</span> <span class="n">shouldn</span><span class="s1">&#39;t be longer than 72</span>
<span class="n">characters</span><span class="o">.</span>  <span class="n">If</span> <span class="n">the</span> <span class="n">commit</span> <span class="ow">is</span> <span class="n">related</span> <span class="n">to</span> <span class="n">a</span> <span class="n">ticket</span><span class="p">,</span> <span class="n">indicate</span> <span class="n">that</span> <span class="k">with</span>
<span class="s2">&quot;See #3456&quot;</span><span class="p">,</span> <span class="s2">&quot;See ticket 3456&quot;</span><span class="p">,</span> <span class="s2">&quot;Closes #3456&quot;</span> <span class="ow">or</span> <span class="n">similar</span><span class="o">.</span>
</pre></div>
</div>
<p>Describing the motivation for a change, the nature of a bug for bug fixes
or some details on what an enhancement does are also good to include in a
commit message. Messages should be understandable without looking at the code
changes.</p>
<p>Standard acronyms to start the commit message with are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">API</span><span class="p">:</span> <span class="n">an</span> <span class="p">(</span><span class="n">incompatible</span><span class="p">)</span> <span class="n">API</span> <span class="n">change</span>
<span class="n">BLD</span><span class="p">:</span> <span class="n">change</span> <span class="n">related</span> <span class="n">to</span> <span class="n">building</span> <span class="n">numpy</span>
<span class="n">BUG</span><span class="p">:</span> <span class="n">bug</span> <span class="n">fix</span>
<span class="n">CI</span> <span class="p">:</span> <span class="n">continuous</span> <span class="n">integration</span>
<span class="n">DEP</span><span class="p">:</span> <span class="n">deprecate</span> <span class="n">something</span><span class="p">,</span> <span class="ow">or</span> <span class="n">remove</span> <span class="n">a</span> <span class="n">deprecated</span> <span class="nb">object</span>
<span class="n">DEV</span><span class="p">:</span> <span class="n">development</span> <span class="n">tool</span> <span class="ow">or</span> <span class="n">utility</span>
<span class="n">DOC</span><span class="p">:</span> <span class="n">documentation</span>
<span class="n">ENH</span><span class="p">:</span> <span class="n">enhancement</span>
<span class="n">MNT</span><span class="p">:</span> <span class="n">maintenance</span> <span class="n">commit</span> <span class="p">(</span><span class="n">refactoring</span><span class="p">,</span> <span class="n">typos</span><span class="p">,</span> <span class="n">etc</span><span class="o">.</span><span class="p">)</span>
<span class="n">REV</span><span class="p">:</span> <span class="n">revert</span> <span class="n">an</span> <span class="n">earlier</span> <span class="n">commit</span>
<span class="n">STY</span><span class="p">:</span> <span class="n">style</span> <span class="n">fix</span> <span class="p">(</span><span class="n">whitespace</span><span class="p">,</span> <span class="n">PEP8</span><span class="p">)</span>
<span class="n">TST</span><span class="p">:</span> <span class="n">addition</span> <span class="ow">or</span> <span class="n">modification</span> <span class="n">of</span> <span class="n">tests</span>
<span class="n">REL</span><span class="p">:</span> <span class="n">related</span> <span class="n">to</span> <span class="n">releases</span>
</pre></div>
</div>
</section>
<section id="the-pull-request">
<h3>The Pull Request<a class="headerlink" href="#the-pull-request" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Now push to your fork</p></li>
<li><p>Submit a <a class="reference external" href="https://help.github.com/articles/using-pull-requests">pull request</a> to this branch. This is a start to the conversation.</p></li>
</ul>
<p>At this point you’re waiting on us. We like to at least comment on pull requests within three business days
(and, typically, one business day). We may suggest some changes or improvements or alternatives.</p>
<p>Hints to make the integration of your changes easy (and happen faster):</p>
<ul class="simple">
<li><p>Keep your pull requests small</p></li>
<li><p>Don’t forget your unit tests</p></li>
<li><p>All algorithms need documentation, don’t forget the .rst file</p></li>
<li><p>Don’t take changes requests to change your code personally</p></li>
</ul>
</section>
</section>
<section id="installation-of-the-queue-server-for-development">
<h2>Installation of the Queue Server for Development<a class="headerlink" href="#installation-of-the-queue-server-for-development" title="Link to this heading"></a></h2>
<p>Install Redis and create Conda environment as described in <a class="reference internal" href="installation.html#installation-steps"><span class="std std-ref">Installation Steps</span></a>.</p>
<p>Install the Queue Server in editable mode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install -e .
</pre></div>
</div>
<p>Install development dependencies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install -r requirements-dev.txt
</pre></div>
</div>
</section>
<section id="setting-up-pre-commit">
<h2>Setting up <cite>pre-commit</cite><a class="headerlink" href="#setting-up-pre-commit" title="Link to this heading"></a></h2>
<p><cite>pre-commit`</cite> package is installed as part of the development requirements. Install pre-commit
script by running</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pre-commit install
</pre></div>
</div>
<p>Once installed, <cite>pre-commit</cite> will perform all the checks before each commit. As the new versions
of validation packages are released, the pre-commit script can be updated by running</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pre-commit autoupdate
</pre></div>
</div>
</section>
<section id="running-unit-tests-locally">
<h2>Running Unit Tests Locally<a class="headerlink" href="#running-unit-tests-locally" title="Link to this heading"></a></h2>
<p>The Queue Server must be tested separately with disabled IPython mode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pytest -vvv
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ USE_IPYKERNEL=false pytest -vvv
</pre></div>
</div>
<p>and enabled IPython mode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ USE_IPYKERNEL=true pytest -vvv
</pre></div>
</div>
</section>
<section id="running-unit-tests-on-github">
<h2>Running Unit Tests on GitHub<a class="headerlink" href="#running-unit-tests-on-github" title="Link to this heading"></a></h2>
<p>Execution of the full test suite on CI takes too long and causes major inconvenience,
therefore it is split into multiple groups (currently 3 groups) using <cite>pytest-split</cite>
package. Since the goal is to reduce the execution time of the longest group, the
splitting algorithm is calibrated based on execution time of the tests with enabled
IPython kernel mode (more tests, each test takes a little longer to execute).
Calibration is performed by running the script <code class="docutils literal notranslate"><span class="pre">store_test_durations.sh</span></code> locally,
which saves execution time for each test in the <code class="docutils literal notranslate"><span class="pre">`.test_durations</span></code> file. The file then
has to be committed and pushed to the repository.</p>
<p><cite>pytest-split</cite> will automatically guess execution time for new tests that are not
listed in <code class="docutils literal notranslate"><span class="pre">.test_durations</span></code> file, so calibration may be needed rarely or after major
changes to the test suite and should be left to the package maintainers.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="release_history.html" class="btn btn-neutral float-left" title="Release History" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="introduction_for_users.html" class="btn btn-neutral float-right" title="Introduction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2021, Brookhaven National Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>