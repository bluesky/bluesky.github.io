

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Interacting with Queue Server &mdash; bluesky-queueserver 0.0.22.post29+g07cb925 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="_static/theme_overrides.css?v=0c24fe83" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=d91e99de"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="bluesky_queueserver.ReceiveConsoleOutput" href="generated/bluesky_queueserver.ReceiveConsoleOutput.html" />
    <link rel="prev" title="qserver : Quick Introduction" href="qserver_quick_ref.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            bluesky-queueserver
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_history.html">Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/bluesky/bluesky-queueserver">Source Code on GitHub</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User's Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction_for_users.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_queue_server.html">Using the Queue Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="features_and_config.html">Features and Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="startup_code.html">Organizing Bluesky Startup Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="item_validation.html">Validation of Queue Items</a></li>
<li class="toctree-l1"><a class="reference internal" href="plan_annotation.html">Annotating Bluesky Plans</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli_tools.html">Command-Line Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="manager_config.html">RE Manager Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="qserver_quick_ref.html"><em>qserver</em> : Quick Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Application Developer's Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Interacting with Queue Server</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#subscribing-to-published-console-output">Subscribing to Published Console Output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutput.html">bluesky_queueserver.ReceiveConsoleOutput</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutput.subscribe.html">bluesky_queueserver.ReceiveConsoleOutput.subscribe</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutput.unsubscribe.html">bluesky_queueserver.ReceiveConsoleOutput.unsubscribe</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutput.recv.html">bluesky_queueserver.ReceiveConsoleOutput.recv</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutputAsync.html">bluesky_queueserver.ReceiveConsoleOutputAsync</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutputAsync.subscribe.html">bluesky_queueserver.ReceiveConsoleOutputAsync.subscribe</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutputAsync.unsubscribe.html">bluesky_queueserver.ReceiveConsoleOutputAsync.unsubscribe</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutputAsync.recv.html">bluesky_queueserver.ReceiveConsoleOutputAsync.recv</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutputAsync.set_callback.html">bluesky_queueserver.ReceiveConsoleOutputAsync.set_callback</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutputAsync.start.html">bluesky_queueserver.ReceiveConsoleOutputAsync.start</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutputAsync.stop.html">bluesky_queueserver.ReceiveConsoleOutputAsync.stop</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#formatting-descriptions-of-plans-and-plan-parameters">Formatting Descriptions of Plans and Plan Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/bluesky_queueserver.format_text_descriptions.html">bluesky_queueserver.format_text_descriptions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="re_manager_api.html">Run Engine Manager API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Related Projects</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/bluesky-queueserver-api">Bluesky Queue Server API</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/bluesky-httpserver">Bluesky HTTP Server</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/bluesky-widgets">Bluesky Widgets</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/bluesky">Bluesky</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/ophyd">Ophyd</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io/databroker">Data Broker</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">bluesky-queueserver</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Interacting with Queue Server</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/interacting_with_qs.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="interacting-with-queue-server">
<h1>Interacting with Queue Server<a class="headerlink" href="#interacting-with-queue-server" title="Link to this heading"></a></h1>
<section id="subscribing-to-published-console-output">
<span id="subscribing-to-console-output"></span><h2>Subscribing to Published Console Output<a class="headerlink" href="#subscribing-to-published-console-output" title="Link to this heading"></a></h2>
<p>If console output publishing is enabled at RE Manager (parameter <code class="docutils literal notranslate"><span class="pre">--zmq-publish</span></code>), the output
is published to 0MQ socket. Client applications may subscribe to the messages and use them
for processing, display them to users or forward to other applications.</p>
<p>The messages are published to a <code class="docutils literal notranslate"><span class="pre">PUB</span></code> 0MQ socket running. Multiple applications may subscribe
to the socket simultaneously. The clients must be subscribed to the socket to receive the messages.
The messages are not delivered to the client if they are published while the client is
not subscribed to the socket. The messages are published using the topic named <code class="docutils literal notranslate"><span class="pre">QS_Console</span></code>.</p>
<p>Each message contains timestamped string printed by RE Manager. Some strings can be empty or
contain multiple lines. Messages are python JSON-represented dictionaries with the following
format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">timestamp</span><span class="o">&gt;</span><span class="p">,</span> <span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">message</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&lt;timestamp&gt;</span></code> is floating point number (returned by <code class="docutils literal notranslate"><span class="pre">time.time()</span></code>) and <code class="docutils literal notranslate"><span class="pre">&lt;message&gt;</span></code> is a string.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">bluesky-queueserver</span></code> package provides convenience API class (<code class="docutils literal notranslate"><span class="pre">ReceiveConsoleOutput</span></code>) for
use in synchronous or thread-based applications. The class provides <code class="docutils literal notranslate"><span class="pre">subscribe()</span></code> and <code class="docutils literal notranslate"><span class="pre">unsubscribe()</span></code>
methods that enable caching of published messages by 0MQ and blocking <code class="docutils literal notranslate"><span class="pre">recv()</span></code> method (with timeout)
for loading published messages. See the class documentation for detailed description of the methods
and code examples.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutput.html#bluesky_queueserver.ReceiveConsoleOutput" title="bluesky_queueserver.ReceiveConsoleOutput"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReceiveConsoleOutput</span></code></a></p></td>
<td><p>The class allows to subscribe to published 0MQ messages and read the messages one by one as they arrive.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutput.subscribe.html#bluesky_queueserver.ReceiveConsoleOutput.subscribe" title="bluesky_queueserver.ReceiveConsoleOutput.subscribe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReceiveConsoleOutput.subscribe</span></code></a></p></td>
<td><p>Subscribe 0MQ socket to the console output topic.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutput.unsubscribe.html#bluesky_queueserver.ReceiveConsoleOutput.unsubscribe" title="bluesky_queueserver.ReceiveConsoleOutput.unsubscribe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReceiveConsoleOutput.unsubscribe</span></code></a></p></td>
<td><p>Unsubscribe 0MQ socket from the console output topic.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutput.recv.html#bluesky_queueserver.ReceiveConsoleOutput.recv" title="bluesky_queueserver.ReceiveConsoleOutput.recv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReceiveConsoleOutput.recv</span></code></a></p></td>
<td><p>Get the next published message.</p></td>
</tr>
</tbody>
</table>
<p>Asyncio-based applications (e.g. HTTP server) may use <code class="docutils literal notranslate"><span class="pre">ReceiveConsoleOutputAsync</span></code> API class to
receive captured console output. The class provides <code class="docutils literal notranslate"><span class="pre">subscribe()</span></code> and <code class="docutils literal notranslate"><span class="pre">unsubscribe()</span></code> methods
to explicitly subscribe and unsubscribe 0MQ socket. The class may be used in two modes: polling
using <code class="docutils literal notranslate"><span class="pre">recv()</span></code> method or setting callback function or coroutine with <code class="docutils literal notranslate"><span class="pre">set_callback()</span></code> method
and starting and then stopping acquisition with <code class="docutils literal notranslate"><span class="pre">start()</span></code> and <code class="docutils literal notranslate"><span class="pre">stop()</span></code> methods.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutputAsync.html#bluesky_queueserver.ReceiveConsoleOutputAsync" title="bluesky_queueserver.ReceiveConsoleOutputAsync"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReceiveConsoleOutputAsync</span></code></a></p></td>
<td><p>Async version of <code class="docutils literal notranslate"><span class="pre">ReceiveConsoleOutput</span></code> class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutputAsync.subscribe.html#bluesky_queueserver.ReceiveConsoleOutputAsync.subscribe" title="bluesky_queueserver.ReceiveConsoleOutputAsync.subscribe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReceiveConsoleOutputAsync.subscribe</span></code></a></p></td>
<td><p>Subscribe 0MQ socket to the console output topic.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutputAsync.unsubscribe.html#bluesky_queueserver.ReceiveConsoleOutputAsync.unsubscribe" title="bluesky_queueserver.ReceiveConsoleOutputAsync.unsubscribe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReceiveConsoleOutputAsync.unsubscribe</span></code></a></p></td>
<td><p>Unsubscribe 0MQ socket from the console output topic.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutputAsync.recv.html#bluesky_queueserver.ReceiveConsoleOutputAsync.recv" title="bluesky_queueserver.ReceiveConsoleOutputAsync.recv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReceiveConsoleOutputAsync.recv</span></code></a></p></td>
<td><p>Get the next published message.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutputAsync.set_callback.html#bluesky_queueserver.ReceiveConsoleOutputAsync.set_callback" title="bluesky_queueserver.ReceiveConsoleOutputAsync.set_callback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReceiveConsoleOutputAsync.set_callback</span></code></a></p></td>
<td><p>Set callback function, which is called once for each received message.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutputAsync.start.html#bluesky_queueserver.ReceiveConsoleOutputAsync.start" title="bluesky_queueserver.ReceiveConsoleOutputAsync.start"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReceiveConsoleOutputAsync.start</span></code></a></p></td>
<td><p>Start collection of messages published by RE Manager.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/bluesky_queueserver.ReceiveConsoleOutputAsync.stop.html#bluesky_queueserver.ReceiveConsoleOutputAsync.stop" title="bluesky_queueserver.ReceiveConsoleOutputAsync.stop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReceiveConsoleOutputAsync.stop</span></code></a></p></td>
<td><p>Stop collection of messages published by RE Manager.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="formatting-descriptions-of-plans-and-plan-parameters">
<h2>Formatting Descriptions of Plans and Plan Parameters<a class="headerlink" href="#formatting-descriptions-of-plans-and-plan-parameters" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">format_text_descriptions</span></code> function may be used to generate formatted text descriptions of
plans and plan parameters. The formatted descriptions are intended to be displayed to users
by client applications. See the docstring for the function for more details.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/bluesky_queueserver.format_text_descriptions.html#bluesky_queueserver.format_text_descriptions" title="bluesky_queueserver.format_text_descriptions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">format_text_descriptions</span></code></a></p></td>
<td><p>Format parameter descriptions for a plan from the list of allowed plans.</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="qserver_quick_ref.html" class="btn btn-neutral float-left" title="qserver : Quick Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="generated/bluesky_queueserver.ReceiveConsoleOutput.html" class="btn btn-neutral float-right" title="bluesky_queueserver.ReceiveConsoleOutput" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2021, Brookhaven National Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>