


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Databroker &mdash; databroker 1.2.0.post70+g3f93acc4 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation Tutorial" href="tutorials/install.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> databroker
          

          
          </a>

          
            
            
              <div class="version">
                1.2.0.post70+g3f93acc4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/install.html">Installation Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/search-and-lookup.html">Find Runs in a Catalog</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/get-data.html">Get Data from a Run</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/get-metadata.html">Navigate Metadata in a Run</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/export.html">Export Data</a></li>
</ul>
<p class="caption"><span class="caption-text">How-to Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how-to/download-data-samples.html">How to download some Catalogs with data samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="how-to/file-backed-catalog.html">How to create a new Catalog backed by files</a></li>
<li class="toctree-l1"><a class="reference internal" href="how-to/store-data-from-run-engine.html">How to store data from the Run Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="how-to/store-analysis-results.html">How to store analysis results</a></li>
<li class="toctree-l1"><a class="reference internal" href="how-to/mongo-backed-catalog.html">How to create a new Catalog backed by MongoDB</a></li>
</ul>
<p class="caption"><span class="caption-text">Explanations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="explanations/v2-transition.html">What are the API versions v0, v1, v2?</a></li>
<li class="toctree-l1"><a class="reference internal" href="explanations/local-and-remote-use-cases.html">How can it be used locally and remotely?</a></li>
<li class="toctree-l1"><a class="reference internal" href="explanations/relationship-to-intake.html">What is Databroker’s relationship to Intake?</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reference/v2.html">New (v2) API</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference/v1.html">Original (v1 / v0) API</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference/configuration.html">Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference/changelog.html">Changelog</a></li>
</ul>
<p class="caption"><span class="caption-text">Bluesky Project</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://blueskyproject.io">Homepage</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/bluesky">GitHub</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Help</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://gitter.im/NSLS-II/DAMA">Gitter</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">databroker</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>Databroker</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="databroker">
<h1>Databroker<a class="headerlink" href="#databroker" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://github.com/bluesky/databroker/actions?query=workflow%3A%22Unit+Tests%22"><img alt="Build Status" src="https://github.com/bluesky/databroker/workflows/Unit%20Tests/badge.svg?branch=master" /></a> <a class="reference external" href="https://codecov.io/gh/bluesky/databroker"><img alt="Test Coverage" src="https://codecov.io/gh/bluesky/databroker/branch/master/graph/badge.svg" /></a> <a class="reference external" href="https://pypi.org/project/databroker"><img alt="Latest PyPI version" src="https://img.shields.io/pypi/v/databroker.svg" /></a> <a class="reference external" href="https://opensource.org/licenses/BSD-3-Clause"><img alt="BSD 3-Clause License" src="https://img.shields.io/badge/License-BSD%203--Clause-blue.svg" /></a></p>
<p>Databroker is a data <strong>access</strong> tool built around the <a class="reference external" href="https://blueskyproject.io/event-model/data-model.html">Bluesky Data Model</a>.
The data it manages may be from ingested files, captured results of a
Python-based data analysis, or experimental data acquired using the Bluesky Run
Engine.</p>
<ul class="simple">
<li><p>Provide a consistent programmatic interface to data, <strong>regardless of storage
details</strong> like file format or storage medium.</p></li>
<li><p>Provide <strong>metadata and data</strong> in a coherent bundle, using standard widely-used
Python and SciPy data structures.</p></li>
<li><p>Support fast, flexible <strong>search</strong> over metadata.</p></li>
<li><p>Enable software tools to operate seamlessly on a
mixture of <strong>live-streaming</strong> data from the Bluesky Run Engine and <strong>saved</strong>
data from Databroker.</p></li>
</ul>
<p>Databroker is developed in concert with <a class="reference external" href="https://blueskyproject.io/suitcase/">Suitcase</a>. Suitcase does data
<em>writing</em>, and databroker does the reading. Databroker builds on <a class="reference external" href="https://intake.readthedocs.io/en/latest/">Intake</a>, a
generic data access tool (outside of the Bluesky Project).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>PyPI</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">databroker</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Conda</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-c</span> <span class="pre">nsls2forge</span> <span class="pre">databroker</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Source code</p></td>
<td><p><a class="reference external" href="https://github.com/bluesky/databroker">https://github.com/bluesky/databroker</a></p></td>
</tr>
<tr class="row-even"><td><p>Documentation</p></td>
<td><p><a class="reference external" href="https://blueskyproject.io/databroker">https://blueskyproject.io/databroker</a></p></td>
</tr>
</tbody>
</table>
<p>The bundle of metadata and data looks like this, for example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run</span>
<span class="go">BlueskyRun</span>
<span class="go">  uid=&#39;4a794c63-8223-4893-895e-d16e763188a8&#39;</span>
<span class="go">  exit_status=&#39;success&#39;</span>
<span class="go">  2020-03-07 09:17:40.436 -- 2020-03-07 09:28:53.173</span>
<span class="go">  Streams:</span>
<span class="go">    * primary</span>
<span class="go">    * baseline</span>
</pre></div>
</div>
<p>Additional user metadata beyond what is shown is stored in <code class="docutils literal notranslate"><span class="pre">run.metadata</span></code>.
The bundle contains some number of logical tables of data (“streams”). They can
be accessed by name and read into a standard data structure from <a class="reference external" href="https://xarray.pydata.org/">xarray</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run</span><span class="o">.</span><span class="n">primary</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">&lt;xarray.Dataset&gt;</span>
<span class="go">Dimensions:                   (time: 411)</span>
<span class="go">Coordinates:</span>
<span class="go">  * time                      (time) float64 1.584e+09 1.584e+09 ... 1.584e+09</span>
<span class="go">Data variables:</span>
<span class="go">    I0                        (time) float64 13.07 13.01 12.95 ... 9.862 9.845</span>
<span class="go">    It                        (time) float64 11.52 11.47 11.44 ... 4.971 4.968</span>
<span class="go">    Ir                        (time) float64 10.96 10.92 10.88 ... 4.761 4.763</span>
<span class="go">    dwti_dwell_time           (time) float64 1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0</span>
<span class="go">    dwti_dwell_time_setpoint  (time) float64 1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0</span>
<span class="go">    dcm_energy                (time) float64 1.697e+04 1.698e+04 ... 1.791e+04</span>
<span class="go">    dcm_energy_setpoint       (time) float64 1.697e+04 1.698e+04 ... 1.791e+04</span>
</pre></div>
</div>
<p>Common search queries can be done with a high-level Python interface.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">databroker.queries</span> <span class="kn">import</span> <span class="n">TimeRange</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">TimeRange</span><span class="p">(</span><span class="n">since</span><span class="o">=</span><span class="s2">&quot;2020&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Custom queries can be done with the <a class="reference external" href="https://docs.mongodb.com/manual/reference/operator/query/">MongoDB query language</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>   <span class="s2">&quot;motors&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$in&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]},</span>  <span class="c1"># scanning either x or y</span>
<span class="gp">... </span>   <span class="s2">&quot;temperature&quot;</span> <span class="p">{</span><span class="s2">&quot;$lt&quot;</span><span class="p">:</span> <span class="mi">300</span><span class="p">},</span>  <span class="c1"># temperature less than 300</span>
<span class="gp">... </span>   <span class="s2">&quot;sample.element&quot;</span><span class="p">:</span> <span class="s2">&quot;Ni&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</pre></div>
</div>
<p>See the tutorials for more.</p>
<div class="section" id="how-the-documentation-is-structured">
<h2>How the documentation is structured<a class="headerlink" href="#how-the-documentation-is-structured" title="Permalink to this headline">¶</a></h2>
<div class="columns section" id="tutorials">
<h3><a class="reference internal" href="#id1"><span class="std std-ref">Tutorials</span></a><a class="headerlink" href="#tutorials" title="Permalink to this headline">¶</a></h3>
<p>Tutorials for installation and usage. New users start here.</p>
</div>
<div class="columns section" id="how-to">
<h3><a class="reference internal" href="#id2"><span class="std std-ref">How-to Guides</span></a><a class="headerlink" href="#how-to" title="Permalink to this headline">¶</a></h3>
<p>Practical step-by-step guides for the more experienced user.</p>
</div>
<div class="columns section" id="explanations">
<h3><a class="reference internal" href="#id3"><span class="std std-ref">Explanations</span></a><a class="headerlink" href="#explanations" title="Permalink to this headline">¶</a></h3>
<p>Explanation of how the library works and why it works that way.</p>
</div>
<div class="columns section" id="reference">
<h3><a class="reference internal" href="#id4"><span class="std std-ref">Reference</span></a><a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h3>
<p>Technically detailed API documenation.</p>
</div>
<div class="endcolumns section" id="about-the-documentation">
<h3>About the documentation<a class="headerlink" href="#about-the-documentation" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://documentation.divio.com">Why is the documentation structured this way?</a></p>
<div class="toctree-wrapper compound" id="id1">
<p class="caption"><span class="caption-text">Tutorials</span><a class="headerlink" href="#id1" title="Permalink to this toctree">¶</a></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/install.html">Installation Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/search-and-lookup.html">Find Runs in a Catalog</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/get-data.html">Get Data from a Run</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/get-metadata.html">Navigate Metadata in a Run</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/export.html">Export Data</a></li>
</ul>
</div>
<div class="toctree-wrapper compound" id="id2">
<p class="caption"><span class="caption-text">How-to Guides</span><a class="headerlink" href="#id2" title="Permalink to this toctree">¶</a></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how-to/download-data-samples.html">How to download some Catalogs with data samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="how-to/file-backed-catalog.html">How to create a new Catalog backed by files</a></li>
<li class="toctree-l1"><a class="reference internal" href="how-to/store-data-from-run-engine.html">How to store data from the Run Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="how-to/store-analysis-results.html">How to store analysis results</a></li>
<li class="toctree-l1"><a class="reference internal" href="how-to/mongo-backed-catalog.html">How to create a new Catalog backed by MongoDB</a></li>
</ul>
</div>
<div class="toctree-wrapper compound" id="id3">
<p class="caption"><span class="caption-text">Explanations</span><a class="headerlink" href="#id3" title="Permalink to this toctree">¶</a></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="explanations/v2-transition.html">What are the API versions v0, v1, v2?</a></li>
<li class="toctree-l1"><a class="reference internal" href="explanations/local-and-remote-use-cases.html">How can it be used locally and remotely?</a></li>
<li class="toctree-l1"><a class="reference internal" href="explanations/relationship-to-intake.html">What is Databroker’s relationship to Intake?</a></li>
</ul>
</div>
<div class="toctree-wrapper no-margin-after-ul compound" id="id4">
<p class="caption"><span class="caption-text">Reference</span><a class="headerlink" href="#id4" title="Permalink to this toctree">¶</a></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reference/v2.html">New (v2) API</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference/v1.html">Original (v1 / v0) API</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference/configuration.html">Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference/changelog.html">Changelog</a></li>
</ul>
</div>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
</ul>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="tutorials/install.html" class="btn btn-neutral float-right" title="Installation Tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2015 Brookhaven National Lab.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>