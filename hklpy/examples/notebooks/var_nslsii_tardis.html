<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NSLS-II TARDIS Configuration &mdash; hklpy 0+untagged.1.ga7ddc35 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="UB : Save and Restore Crystal Orientation" href="tst_UB_in_descriptor_document.html" />
    <link rel="prev" title="Use E4CV’s \(Q\) calculation engine" href="var_engines.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            hklpy
          </a>
              <div class="version">
                0+untagged.1.ga7ddc35
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Core Functionality</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">How to install <cite>hklpy</cite></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Ready-to-Use Devices</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../ready_to_use.html">Ready-to-Use Devices</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#diffractometer-geometries">Diffractometer Geometries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#how-to-guides">How-to Guides</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#variations">Variations</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="var_e4cv_renamed_axes.html">Rename the axes of a 4-circle diffractometer</a></li>
<li class="toctree-l3"><a class="reference internal" href="var_engines.html">Use <code class="docutils literal notranslate"><span class="pre">E4CV</span></code>’s <span class="math notranslate nohighlight">\(Q\)</span> calculation engine</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">NSLS-II TARDIS Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#HKL-PseudoPositioner-Use">HKL PseudoPositioner Use</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Move-to-(101)-reflection">Move to (101) reflection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Move-to-(102)-reflection">Move to (102) reflection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#tests-and-comparisons">Tests and Comparisons</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release History</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">hklpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Examples</a></li>
      <li class="breadcrumb-item active">NSLS-II TARDIS Configuration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/examples/notebooks/var_nslsii_tardis.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="NSLS-II-TARDIS-Configuration">
<h1>NSLS-II TARDIS Configuration<a class="headerlink" href="#NSLS-II-TARDIS-Configuration" title="Permalink to this heading">¶</a></h1>
<p>This notebook documents some calculations using a simulation of the Tardis diffractometer (an <code class="docutils literal notranslate"><span class="pre">E6C</span></code> variation) at NSLS-II. The connections with the EPICS motors have been replaced with simulated motors for this example.</p>
<p>Using the <code class="docutils literal notranslate"><span class="pre">`E6C</span></code> &lt;<a class="reference external" href="https://people.debian.org/~picca/hkl/hkl.html#orge5e0490">https://people.debian.org/~picca/hkl/hkl.html#orge5e0490</a>&gt;`__ geometry from <a class="reference external" href="https://people.debian.org/~picca/hkl/hkl.html">libhkl</a>, &#64;cmazzoli found that, in this geometry, with the “lifting_detector_mu” mode, the following mapping applies:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>libhkl</p></th>
<th class="head"><p>TARDIS</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>mu</p></td>
<td><p>theta</p></td>
</tr>
<tr class="row-odd"><td><p>gamma</p></td>
<td><p>delta</p></td>
</tr>
<tr class="row-even"><td><p>delta</p></td>
<td><p>gamma</p></td>
</tr>
<tr class="row-odd"><td><p>phi</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p>chi</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p>omega</p></td>
<td><p>None</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>The diffractometer geometry with angle and axis definitions are depicted below</p></li>
</ul>
<p><img alt="075d423a89864c3b86fe8ba8e62ef20e" class="no-scaled-link" src="../../_images/6-circle-schematic.png" style="width: 480px; height: 320px;" /></p>
<ul class="simple">
<li><p><em>libhkl</em> documentation of the <a class="reference external" href="https://people.debian.org/~picca/hkl/hkl.html#orge5e0490">E6C (Eulerian 6-circle) geometry</a></p></li>
</ul>
<p>Begin by instantiating a calculation engine of the appropriate geometry, and configuring its mode as <strong>lifting_detector_mu</strong> . We must reach into the <code class="docutils literal notranslate"><span class="pre">hkl.calc</span></code> module to import <code class="docutils literal notranslate"><span class="pre">CalcE6C</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hkl.calc</span> <span class="kn">import</span> <span class="n">CalcE6C</span>

<span class="n">tardis_calc</span> <span class="o">=</span> <span class="n">CalcE6C</span><span class="p">()</span>

<span class="c1"># what modes are available?</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Available modes: </span><span class="si">{</span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">modes</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">physical_axes</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">pseudo_axes</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Available modes: tardis_calc.engine.modes = [&#39;bissector_vertical&#39;, &#39;constant_omega_vertical&#39;, &#39;constant_chi_vertical&#39;, &#39;constant_phi_vertical&#39;, &#39;lifting_detector_phi&#39;, &#39;lifting_detector_omega&#39;, &#39;lifting_detector_mu&#39;, &#39;double_diffraction_vertical&#39;, &#39;bissector_horizontal&#39;, &#39;double_diffraction_horizontal&#39;, &#39;psi_constant_vertical&#39;, &#39;psi_constant_horizontal&#39;, &#39;constant_mu_horizontal&#39;]
tardis_calc.physical_axes = OrderedDict([(&#39;mu&#39;, 0.0), (&#39;omega&#39;, 0.0), (&#39;chi&#39;, 0.0), (&#39;phi&#39;, 0.0), (&#39;gamma&#39;, 0.0), (&#39;delta&#39;, 0.0)])
tardis_calc.pseudo_axes = OrderedDict([(&#39;h&#39;, 0.0), (&#39;k&#39;, 0.0), (&#39;l&#39;, 0.0)])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lifting_detector_mu&#39;</span>
</pre></div>
</div>
</div>
<p>Next, seed the calculation engine with a parameterized sample and wavelength (or energy).</p>
<p><strong>NOTE</strong>: length units are in Angstrom, angles are in degrees, and energy is in keV.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hkl</span> <span class="kn">import</span> <span class="n">Lattice</span>

<span class="c1"># lattice cell lengths are in Angstrom, angles are in degrees</span>
<span class="n">lattice</span> <span class="o">=</span> <span class="n">Lattice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">9.069</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">9.069</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">10.390</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">120.0</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">tardis_calc</span><span class="o">.</span><span class="n">new_sample</span><span class="p">(</span><span class="s1">&#39;sample1&#39;</span><span class="p">,</span> <span class="n">lattice</span><span class="o">=</span><span class="n">lattice</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sample</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
sample = HklSample(name=&#39;sample1&#39;, lattice=LatticeTuple(a=9.069, b=9.069, c=10.39, alpha=90.0, beta=90.0, gamma=119.99999999999999), ux=Parameter(name=&#39;None (internally: ux)&#39;, limits=(min=-180.0, max=180.0), value=0.0, fit=True, inverted=False, units=&#39;Degree&#39;), uy=Parameter(name=&#39;None (internally: uy)&#39;, limits=(min=-180.0, max=180.0), value=0.0, fit=True, inverted=False, units=&#39;Degree&#39;), uz=Parameter(name=&#39;None (internally: uz)&#39;, limits=(min=-180.0, max=180.0), value=0.0, fit=True, inverted=False, units=&#39;Degree&#39;), U=array([[1., 0., 0.],
       [0., 1., 0.],
       [0., 0., 1.]]), UB=array([[ 7.99999720e-01,  3.99999860e-01, -6.41365809e-17],
       [ 0.00000000e+00,  6.92820080e-01, -6.41365809e-17],
       [ 0.00000000e+00,  0.00000000e+00,  6.04733908e-01]]), reflections=[])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="mf">1.61198</span>  <span class="c1"># in Angstrom</span>

<span class="c1"># just to check</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Energy: </span><span class="si">{</span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">energy</span><span class="w"> </span><span class="si">= }</span><span class="s2"> keV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Energy: tardis_calc.energy = 7.691422871251505 keV
</pre></div></div>
</div>
<p>Now, apply constraints appropriate for TARDIS’ geometry. This includes setting limits on the acceptable ranges of motion, initial (and constant!) values, and whether or not a particular axis should be factored into the fitting function that produces the forward and inverse solutions.</p>
<p>Since we are working with a <code class="docutils literal notranslate"><span class="pre">hkl.calc.CalcRecip</span></code> object, we do not have access to the convenience of the <code class="docutils literal notranslate"><span class="pre">apply_constraints()</span></code> method provided by the <code class="docutils literal notranslate"><span class="pre">hkl.diffract.Diffractometer</span></code> class. We have to set the constraints the hard way. These are the same steps implemented within <code class="docutils literal notranslate"><span class="pre">apply_constraints()</span></code>.</p>
<p><strong>NOTE</strong>: physical motors should be checked that limits are in place prior to initiating any motion. Note also that none of the calculations below are associated with any physical motors, and that there is no connection between “limit” values used in the calculation, and soft-limit values that may be present in a control system for physical motors.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Theta</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">tardis_calc</span><span class="p">[</span><span class="s1">&#39;mu&#39;</span><span class="p">]</span>
<span class="n">mu</span><span class="o">.</span><span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">181</span><span class="p">,</span> <span class="mi">181</span><span class="p">)</span>
<span class="n">mu</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">mu</span><span class="o">.</span><span class="n">fit</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># we don&#39;t have it. Fix to 0</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">tardis_calc</span><span class="p">[</span><span class="s1">&#39;phi&#39;</span><span class="p">]</span>
<span class="n">phi</span><span class="o">.</span><span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">phi</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">phi</span><span class="o">.</span><span class="n">fit</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># we don&#39;t have it. Fix to 0</span>
<span class="n">chi</span> <span class="o">=</span> <span class="n">tardis_calc</span><span class="p">[</span><span class="s1">&#39;chi&#39;</span><span class="p">]</span>
<span class="n">chi</span><span class="o">.</span><span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">chi</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">chi</span><span class="o">.</span><span class="n">fit</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># we don&#39;t have it!! Fix to 0</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">tardis_calc</span><span class="p">[</span><span class="s1">&#39;omega&#39;</span><span class="p">]</span>
<span class="n">omega</span><span class="o">.</span><span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">omega</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">omega</span><span class="o">.</span><span class="n">fit</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># NOTE: Tardis detector stage names are swapped from canonical names!</span>
<span class="c1"># delta</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="n">tardis_calc</span><span class="p">[</span><span class="s1">&#39;gamma&#39;</span><span class="p">]</span>
<span class="n">gamma</span><span class="o">.</span><span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
<span class="n">gamma</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">gamma</span><span class="o">.</span><span class="n">fit</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># gamma</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">tardis_calc</span><span class="p">[</span><span class="s1">&#39;delta&#39;</span><span class="p">]</span>
<span class="n">delta</span><span class="o">.</span><span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
<span class="n">delta</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">delta</span><span class="o">.</span><span class="n">fit</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
<p>We can take a look at the UB matrix, but thus far, it won’t be very interesting</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">UB</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tardis_calc.sample.UB = array([[ 7.99999720e-01,  3.99999860e-01, -6.41365809e-17],
       [ 0.00000000e+00,  6.92820080e-01, -6.41365809e-17],
       [ 0.00000000e+00,  0.00000000e+00,  6.04733908e-01]])
</pre></div></div>
</div>
<p>Add two, known reflections and the motor positions associated with those hkl values. Here, we are using values from &#64;cmazolli’s ESRF notes:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(3,3,0): del = 64.449, gam = -0.871, th = 25.285
(5,2,0): del = 79.712, gam = -1.374, th = 46.816
</pre></div>
</div>
<p><strong>NOTE</strong>: the translation of gamma==delta, delta==gamma, and mu==theta is being used</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r1</span> <span class="o">=</span> <span class="n">tardis_calc</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">add_reflection</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                           <span class="n">position</span><span class="o">=</span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">Position</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">64.449</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">25.285</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">delta</span><span class="o">=-</span><span class="mf">0.871</span><span class="p">))</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">tardis_calc</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">add_reflection</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                           <span class="n">position</span><span class="o">=</span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">Position</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">79.712</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">46.816</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">delta</span><span class="o">=-</span><span class="mf">1.374</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">reflections</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tardis_calc.sample.reflections = [(h=3.0, k=3.0, l=0.0), (h=5.0, k=2.0, l=0.0)]
</pre></div></div>
</div>
<p>Now a UB matrix can be computed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">compute_UB</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 0.31323551, -0.4807593 ,  0.01113654],
       [ 0.73590724,  0.63942704,  0.01003773],
       [-0.01798898, -0.00176066,  0.60454803]])
</pre></div></div>
</div>
<p>Compare some libhkl-generated results with those from &#64;cmazolli’s notes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Experimentally found reflections @ Lambda = 1.61198 A</span>
<span class="c1"># (4, 4, 0) = [90.628, 38.373, 0, 0, 0, -1.156]</span>
<span class="c1"># (4, 1, 0) = [56.100, 40.220, 0, 0, 0, -1.091]</span>
<span class="c1"># @ Lambda = 1.60911</span>
<span class="c1"># (6, 0, 0) = [75.900, 61.000, 0, 0, 0, -1.637]</span>
<span class="c1"># @ Lambda = 1.60954</span>
<span class="c1"># (3, 2, 0) = [53.090, 26.144, 0, 0, 0, -.933]</span>
<span class="c1"># (5, 4, 0) = [106.415, 49.900, 0, 0, 0, -1.535]</span>
<span class="c1"># (4, 5, 0) = [106.403, 42.586, 0, 0, 0, -1.183]</span>
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">forward</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tardis_calc.forward((4,4,0)) = (PosCalcE6C(mu=38.37622128052063, omega=0.0, chi=0.0, phi=0.0, gamma=90.63030469353308, delta=-1.1613181970939916),)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">forward</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tardis_calc.forward((4,1,0)) = (PosCalcE6C(mu=40.21991977757096, omega=0.0, chi=0.0, phi=0.0, gamma=56.09704093977082, delta=-1.083660865503293),)
</pre></div></div>
</div>
<p>Change wavelength here to 1.60911 Angstrom. Note the difference below in <code class="docutils literal notranslate"><span class="pre">delta</span></code> (TARDIS’ gamma axis)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># change wavelength (Angstrom)</span>
<span class="n">tardis_calc</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="mf">1.60911</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">forward</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tardis_calc.forward((6,0,0)) = (PosCalcE6C(mu=60.99346591074179, omega=0.0, chi=0.0, phi=0.0, gamma=75.84521749189147, delta=-1.5839501607961703),)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="mf">1.60954</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">forward</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">forward</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis_calc</span><span class="o">.</span><span class="n">forward</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tardis_calc.forward((3,2,0)) = (PosCalcE6C(mu=26.173823521308144, omega=0.0, chi=0.0, phi=0.0, gamma=53.05207622287554, delta=-0.8437995840438257),)
tardis_calc.forward((5,4,0)) = (PosCalcE6C(mu=49.89232260405601, omega=0.0, chi=0.0, phi=0.0, gamma=106.32053081067247, delta=-1.423656049079967),)
tardis_calc.forward((4,5,0)) = (PosCalcE6C(mu=42.54926633295045, omega=0.0, chi=0.0, phi=0.0, gamma=106.31894239326303, delta=-1.1854071532601609),)
</pre></div></div>
</div>
</section>
<section id="HKL-PseudoPositioner-Use">
<h1>HKL PseudoPositioner Use<a class="headerlink" href="#HKL-PseudoPositioner-Use" title="Permalink to this heading">¶</a></h1>
<p>Let’s explore the idea of an hkl ‘motor’</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ophyd</span> <span class="kn">import</span> <span class="n">Component</span> <span class="k">as</span> <span class="n">Cpt</span>
<span class="kn">from</span> <span class="nn">ophyd</span> <span class="kn">import</span> <span class="p">(</span><span class="n">PseudoSingle</span><span class="p">,</span> <span class="n">EpicsMotor</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">hkl</span> <span class="kn">import</span> <span class="n">SimulatedE6C</span>

<span class="c1"># FIXME: hack to get around what should have been done at init of tardis_calc instance</span>
<span class="n">tardis_calc</span><span class="o">.</span><span class="n">_lock_engine</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">class</span> <span class="nc">Tardis</span><span class="p">(</span><span class="n">SimulatedE6C</span><span class="p">):</span> <span class="o">...</span>

<span class="c1"># class Tardis(E6C):</span>
<span class="c1">#     h = Cpt(PseudoSingle, &#39;&#39;)</span>
<span class="c1">#     k = Cpt(PseudoSingle, &#39;&#39;)</span>
<span class="c1">#     l = Cpt(PseudoSingle, &#39;&#39;)</span>

<span class="c1">#     theta = Cpt(EpicsMotor, &#39;XF:31IDA-OP{Tbl-Ax:X1}Mtr&#39;)</span>
<span class="c1">#     omega = Cpt(EpicsMotor, &#39;XF:31IDA-OP{Tbl-Ax:X2}Mtr&#39;)</span>
<span class="c1">#     chi = Cpt(EpicsMotor, &#39;XF:31IDA-OP{Tbl-Ax:X3}Mtr&#39;)</span>
<span class="c1">#     phi = Cpt(EpicsMotor, &#39;XF:31IDA-OP{Tbl-Ax:X4}Mtr&#39;)</span>
<span class="c1">#     delta = Cpt(EpicsMotor, &#39;XF:31IDA-OP{Tbl-Ax:X5}Mtr&#39;)</span>
<span class="c1">#     gamma = Cpt(EpicsMotor, &#39;XF:31IDA-OP{Tbl-Ax:X6}Mtr&#39;)</span>

<span class="c1"># re-map Tardis&#39; axis names onto what an E6C expects</span>
<span class="n">name_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># tardis: E6C</span>
    <span class="s1">&#39;mu&#39;</span><span class="p">:</span> <span class="s1">&#39;theta&#39;</span><span class="p">,</span>
    <span class="s1">&#39;omega&#39;</span><span class="p">:</span> <span class="s1">&#39;omega&#39;</span><span class="p">,</span>
    <span class="s1">&#39;chi&#39;</span><span class="p">:</span> <span class="s1">&#39;chi&#39;</span><span class="p">,</span>
    <span class="s1">&#39;phi&#39;</span><span class="p">:</span> <span class="s1">&#39;phi&#39;</span><span class="p">,</span>
    <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="s1">&#39;delta&#39;</span><span class="p">,</span>
    <span class="s1">&#39;delta&#39;</span><span class="p">:</span> <span class="s1">&#39;gamma&#39;</span><span class="p">,</span>
    <span class="p">}</span>

<span class="n">tardis</span> <span class="o">=</span> <span class="n">Tardis</span><span class="p">(</span>
    <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="c1"># no prefix</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;tardis&#39;</span><span class="p">,</span> <span class="c1"># local name</span>
    <span class="n">calc_inst</span><span class="o">=</span><span class="n">tardis_calc</span><span class="p">,</span> <span class="c1"># the calc engine setup above</span>
    <span class="c1"># energy=tardis_calc.energy, # FIXME: unexpected keyword argument</span>
<span class="p">)</span>
<span class="n">tardis</span><span class="o">.</span><span class="n">calc</span><span class="o">.</span><span class="n">physical_axis_names</span> <span class="o">=</span> <span class="n">name_map</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis</span><span class="o">.</span><span class="n">calc</span><span class="o">.</span><span class="n">physical_axis_names</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tardis.calc.physical_axis_names = [&#39;theta&#39;, &#39;omega&#39;, &#39;chi&#39;, &#39;phi&#39;, &#39;delta&#39;, &#39;gamma&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis</span><span class="o">.</span><span class="n">real_position</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tardis.real_position = TardisRealPos(mu=0, omega=0, chi=0, phi=0, gamma=0, delta=0)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis</span><span class="o">.</span><span class="n">connected</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tardis.connected = True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Energy: </span><span class="si">{</span><span class="n">tardis</span><span class="o">.</span><span class="n">energy</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="w"> </span><span class="si">= }</span><span class="s2"> keV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Energy: tardis.energy.get() = 8.0 keV
</pre></div></div>
</div>
<section id="Move-to-(101)-reflection">
<h2>Move to (101) reflection<a class="headerlink" href="#Move-to-(101)-reflection" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tardis</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MoveStatus(done=False, pos=tardis, elapsed=0.0, success=False, settle_time=0.0)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">status</span> <span class="o">=</span> <span class="n">_</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">status</span><span class="o">.</span><span class="n">done</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
status.done = True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis</span><span class="o">.</span><span class="n">real_position</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tardis.real_position = TardisRealPos(mu=32.61342481972243, omega=0.0, chi=0.0, phi=0.0, gamma=12.011255441335317, delta=8.64179902840924)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis</span><span class="o">.</span><span class="n">position</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tardis.position = TardisPseudoPos(h=1.0000000000000002, k=-5.667215834780817e-16, l=1.0)
</pre></div></div>
</div>
</section>
<section id="Move-to-(102)-reflection">
<h2>Move to (102) reflection<a class="headerlink" href="#Move-to-(102)-reflection" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tardis</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MoveStatus(done=True, pos=tardis, elapsed=0.0, success=True, settle_time=0.0)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tardis</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([(&#39;tardis_h&#39;,
              {&#39;source&#39;: &#39;PY:tardis_h.position&#39;,
               &#39;dtype&#39;: &#39;number&#39;,
               &#39;shape&#39;: [],
               &#39;upper_ctrl_limit&#39;: 0,
               &#39;lower_ctrl_limit&#39;: 0,
               &#39;units&#39;: &#39;&#39;}),
             (&#39;tardis_h_setpoint&#39;,
              {&#39;source&#39;: &#39;PY:tardis_h.target&#39;,
               &#39;dtype&#39;: &#39;integer&#39;,
               &#39;shape&#39;: [],
               &#39;upper_ctrl_limit&#39;: 0,
               &#39;lower_ctrl_limit&#39;: 0,
               &#39;units&#39;: &#39;&#39;})])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tardis</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([(&#39;tardis_h&#39;, {&#39;value&#39;: 1.0, &#39;timestamp&#39;: 1655096591.5525362}),
             (&#39;tardis_h_setpoint&#39;,
              {&#39;value&#39;: 1, &#39;timestamp&#39;: 1655096591.5525792})])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tardis</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([(&#39;tardis_h&#39;,
              {&#39;source&#39;: &#39;PY:tardis_h.position&#39;,
               &#39;dtype&#39;: &#39;number&#39;,
               &#39;shape&#39;: [],
               &#39;upper_ctrl_limit&#39;: 0,
               &#39;lower_ctrl_limit&#39;: 0,
               &#39;units&#39;: &#39;&#39;}),
             (&#39;tardis_h_setpoint&#39;,
              {&#39;source&#39;: &#39;PY:tardis_h.target&#39;,
               &#39;dtype&#39;: &#39;integer&#39;,
               &#39;shape&#39;: [],
               &#39;upper_ctrl_limit&#39;: 0,
               &#39;lower_ctrl_limit&#39;: 0,
               &#39;units&#39;: &#39;&#39;}),
             (&#39;tardis_k&#39;,
              {&#39;source&#39;: &#39;PY:tardis_k.position&#39;,
               &#39;dtype&#39;: &#39;number&#39;,
               &#39;shape&#39;: [],
               &#39;upper_ctrl_limit&#39;: 0,
               &#39;lower_ctrl_limit&#39;: 0,
               &#39;units&#39;: &#39;&#39;}),
             (&#39;tardis_k_setpoint&#39;,
              {&#39;source&#39;: &#39;PY:tardis_k.target&#39;,
               &#39;dtype&#39;: &#39;integer&#39;,
               &#39;shape&#39;: [],
               &#39;upper_ctrl_limit&#39;: 0,
               &#39;lower_ctrl_limit&#39;: 0,
               &#39;units&#39;: &#39;&#39;}),
             (&#39;tardis_l&#39;,
              {&#39;source&#39;: &#39;PY:tardis_l.position&#39;,
               &#39;dtype&#39;: &#39;number&#39;,
               &#39;shape&#39;: [],
               &#39;upper_ctrl_limit&#39;: 0,
               &#39;lower_ctrl_limit&#39;: 0,
               &#39;units&#39;: &#39;&#39;}),
             (&#39;tardis_l_setpoint&#39;,
              {&#39;source&#39;: &#39;PY:tardis_l.target&#39;,
               &#39;dtype&#39;: &#39;integer&#39;,
               &#39;shape&#39;: [],
               &#39;upper_ctrl_limit&#39;: 0,
               &#39;lower_ctrl_limit&#39;: 0,
               &#39;units&#39;: &#39;&#39;}),
             (&#39;tardis_mu&#39;,
              {&#39;source&#39;: &#39;computed&#39;,
               &#39;dtype&#39;: &#39;number&#39;,
               &#39;shape&#39;: [],
               &#39;units&#39;: &#39;&#39;,
               &#39;lower_ctrl_limit&#39;: -180,
               &#39;upper_ctrl_limit&#39;: 180}),
             (&#39;tardis_omega&#39;,
              {&#39;source&#39;: &#39;computed&#39;,
               &#39;dtype&#39;: &#39;number&#39;,
               &#39;shape&#39;: [],
               &#39;units&#39;: &#39;&#39;,
               &#39;lower_ctrl_limit&#39;: -180,
               &#39;upper_ctrl_limit&#39;: 180}),
             (&#39;tardis_chi&#39;,
              {&#39;source&#39;: &#39;computed&#39;,
               &#39;dtype&#39;: &#39;number&#39;,
               &#39;shape&#39;: [],
               &#39;units&#39;: &#39;&#39;,
               &#39;lower_ctrl_limit&#39;: -180,
               &#39;upper_ctrl_limit&#39;: 180}),
             (&#39;tardis_phi&#39;,
              {&#39;source&#39;: &#39;computed&#39;,
               &#39;dtype&#39;: &#39;number&#39;,
               &#39;shape&#39;: [],
               &#39;units&#39;: &#39;&#39;,
               &#39;lower_ctrl_limit&#39;: -180,
               &#39;upper_ctrl_limit&#39;: 180}),
             (&#39;tardis_gamma&#39;,
              {&#39;source&#39;: &#39;computed&#39;,
               &#39;dtype&#39;: &#39;number&#39;,
               &#39;shape&#39;: [],
               &#39;units&#39;: &#39;&#39;,
               &#39;lower_ctrl_limit&#39;: -180,
               &#39;upper_ctrl_limit&#39;: 180}),
             (&#39;tardis_delta&#39;,
              {&#39;source&#39;: &#39;computed&#39;,
               &#39;dtype&#39;: &#39;number&#39;,
               &#39;shape&#39;: [],
               &#39;units&#39;: &#39;&#39;,
               &#39;lower_ctrl_limit&#39;: -180,
               &#39;upper_ctrl_limit&#39;: 180})])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tardis</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([(&#39;tardis_h&#39;, {&#39;value&#39;: 1.0, &#39;timestamp&#39;: 1655096591.5525362}),
             (&#39;tardis_h_setpoint&#39;,
              {&#39;value&#39;: 1, &#39;timestamp&#39;: 1655096591.5525792}),
             (&#39;tardis_k&#39;,
              {&#39;value&#39;: -1.0351079150284598e-17,
               &#39;timestamp&#39;: 1655096591.5527472}),
             (&#39;tardis_k_setpoint&#39;,
              {&#39;value&#39;: 0, &#39;timestamp&#39;: 1655096591.5527916}),
             (&#39;tardis_l&#39;,
              {&#39;value&#39;: 1.9999999999999998, &#39;timestamp&#39;: 1655096591.552941}),
             (&#39;tardis_l_setpoint&#39;,
              {&#39;value&#39;: 2, &#39;timestamp&#39;: 1655096591.552982}),
             (&#39;tardis_mu&#39;,
              {&#39;value&#39;: 42.936333275662705, &#39;timestamp&#39;: 1655096592.2257466}),
             (&#39;tardis_omega&#39;, {&#39;value&#39;: 0.0, &#39;timestamp&#39;: 1655096592.2257502}),
             (&#39;tardis_chi&#39;, {&#39;value&#39;: 0.0, &#39;timestamp&#39;: 1655096592.225753}),
             (&#39;tardis_phi&#39;, {&#39;value&#39;: 0.0, &#39;timestamp&#39;: 1655096592.225756}),
             (&#39;tardis_gamma&#39;,
              {&#39;value&#39;: 12.143148125839154, &#39;timestamp&#39;: 1655096592.2257588}),
             (&#39;tardis_delta&#39;,
              {&#39;value&#39;: 17.765469685728892, &#39;timestamp&#39;: 1655096592.225762})])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis</span><span class="o">.</span><span class="n">position</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tardis.position = TardisPseudoPos(h=1.0, k=-1.0351079150284598e-17, l=1.9999999999999998)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tardis</span><span class="o">.</span><span class="n">real_position</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tardis.real_position = TardisRealPos(mu=42.936333275662705, omega=0.0, chi=0.0, phi=0.0, gamma=12.143148125839154, delta=17.765469685728892)
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="var_engines.html" class="btn btn-neutral float-left" title="Use E4CV’s \(Q\) calculation engine" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tst_UB_in_descriptor_document.html" class="btn btn-neutral float-right" title="UB : Save and Restore Crystal Orientation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2014-2021, Brookhaven National Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>