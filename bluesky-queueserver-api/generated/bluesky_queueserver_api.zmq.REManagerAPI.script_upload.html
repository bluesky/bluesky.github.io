<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>bluesky_queueserver_api.zmq.REManagerAPI.script_upload &mdash; Bluesky Queue Server API 0.0.10 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="bluesky_queueserver_api.zmq.REManagerAPI.function_execute" href="bluesky_queueserver_api.zmq.REManagerAPI.function_execute.html" />
    <link rel="prev" title="bluesky_queueserver_api.zmq.REManagerAPI.default_lock_key_path" href="bluesky_queueserver_api.zmq.REManagerAPI.default_lock_key_path.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Bluesky Queue Server API
          </a>
              <div class="version">
                0.0.10
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api-reference.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api-reference.html#generation-of-queue-items">Generation of Queue Items</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api-reference.html#miscellaneous-api">Miscellaneous API</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api-reference.html#synchronous-communication-with-0mq-server">Synchronous Communication with 0MQ Server</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="bluesky_queueserver_api.zmq.REManagerAPI.html">bluesky_queueserver_api.zmq.REManagerAPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluesky_queueserver_api.zmq.REManagerAPI.close.html">bluesky_queueserver_api.zmq.REManagerAPI.close</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-reference.html#configuration-of-remanagerapi">Configuration of REManagerAPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-reference.html#low-level-api">Low-Level API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-reference.html#api-for-controlling-re-manager">API for controlling RE Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-reference.html#api-for-controlling-re-environment">API for controlling RE Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-reference.html#api-for-monitoring-available-resources">API for Monitoring Available Resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-reference.html#api-for-management-of-re-queue">API for management of RE Queue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-reference.html#api-for-controlling-re-history">API for Controlling RE History</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-reference.html#api-for-locking-re-manager">API for Locking RE Manager</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../api-reference.html#api-for-executing-tasks">API for Executing Tasks</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">bluesky_queueserver_api.zmq.REManagerAPI.script_upload</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluesky_queueserver_api.zmq.REManagerAPI.function_execute.html">bluesky_queueserver_api.zmq.REManagerAPI.function_execute</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluesky_queueserver_api.zmq.REManagerAPI.task_status.html">bluesky_queueserver_api.zmq.REManagerAPI.task_status</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluesky_queueserver_api.zmq.REManagerAPI.task_result.html">bluesky_queueserver_api.zmq.REManagerAPI.task_result</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluesky_queueserver_api.zmq.REManagerAPI.wait_for_completed_task.html">bluesky_queueserver_api.zmq.REManagerAPI.wait_for_completed_task</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api-reference.html#api-for-controlling-run-engine">API for controlling Run Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-reference.html#api-for-controlling-ipython-kernel">API for controlling IPython kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-reference.html#api-for-monitoring-console-output-of-re-manager">API for monitoring console output of RE manager</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api-reference.html#asynchronous-communication-with-0mq-server">Asynchronous Communication with 0MQ Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api-reference.html#synchronous-communication-with-http-server">Synchronous Communication with HTTP Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api-reference.html#asynchronous-communication-with-http-server">ASynchronous Communication with HTTP Server</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release-history.html">Release History</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Bluesky Queue Server API</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api-reference.html">API Reference</a></li>
      <li class="breadcrumb-item active">bluesky_queueserver_api.zmq.REManagerAPI.script_upload</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/bluesky_queueserver_api.zmq.REManagerAPI.script_upload.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bluesky-queueserver-api-zmq-remanagerapi-script-upload">
<h1>bluesky_queueserver_api.zmq.REManagerAPI.script_upload<a class="headerlink" href="#bluesky-queueserver-api-zmq-remanagerapi-script-upload" title="Permalink to this heading">¶</a></h1>
<dl class="py method">
<dt class="sig sig-object py" id="bluesky_queueserver_api.zmq.REManagerAPI.script_upload">
<span class="sig-prename descclassname"><span class="pre">REManagerAPI.</span></span><span class="sig-name descname"><span class="pre">script_upload</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">script</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_lists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_re</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_in_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lock_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bluesky_queueserver_api.zmq.REManagerAPI.script_upload" title="Permalink to this definition">¶</a></dt>
<dd><p>Upload and execute script in RE Worker namespace. The script may add, modify or
replace objects defined in the namespace, including plans and devices. Dynamic
modification of the worker namespace may be used to implement more flexible workflows.
The API call updates the lists of existing and allowed plans and devices if new plans
or devices are added, modified or deleted by the script. Use <code class="docutils literal notranslate"><span class="pre">task_result</span></code> API
to check if the script was loaded correctly. Note, that if the task fails, the script
is still executed to the point where the exception is raised and the respective changes
to the environment are applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>script: str</strong></dt><dd><p>The string that contains the Python script. The script should satisfy the same
requirements as Bluesky startup scripts. The script can use objects already
existing in the RE Worker namespace.</p>
</dd>
<dt><strong>update_lists: boolean (optional, default True)</strong></dt><dd><p>Update lists of existing and available plans and devices after execution of the script.
It is required to update the lists if the script adds or modifies plans and/or devices
in RE Worker namespace, otherwise it is more efficient to disable the update. For example,
the update could be disabled for the remotely executed scripts that print or modify
variables from the namespace during iteractive debug session.</p>
</dd>
<dt><strong>update_re: boolean (optional, default False)</strong></dt><dd><p>The uploaded scripts may replace Run Engine (<code class="docutils literal notranslate"><span class="pre">RE</span></code>) and Data Broker (<code class="docutils literal notranslate"><span class="pre">db</span></code>)
instances in the namespace. In most cases this operation should not be allowed,
therefore it is disabled by default, i.e. if the script creates new <code class="docutils literal notranslate"><span class="pre">RE</span></code> and
<code class="docutils literal notranslate"><span class="pre">db</span></code> objects, those objects are discarded. Set this parameter <code class="docutils literal notranslate"><span class="pre">True</span></code> to allow
the server to replace RE and db objects. This parameter has no effect if the script
is not creating new instances of <code class="docutils literal notranslate"><span class="pre">RE</span></code> and/or <code class="docutils literal notranslate"><span class="pre">db</span></code>.</p>
</dd>
<dt><strong>run_in_background: boolean (optional, default False)</strong></dt><dd><p>Set this parameter <code class="docutils literal notranslate"><span class="pre">True</span></code> to upload and execute the script in the background
(while a plan or another foreground task is running). Generally, it is not
recommended to update RE Worker namespace in the background. Background tasks
are executed in separate threads and only thread-safe scripts should be uploaded
in the background. <strong>Developers of data acquisition workflows and/or user specific
code are responsible for thread safety.</strong></p>
</dd>
<dt><strong>lock_key: str or None (optional)</strong></dt><dd><p>The lock key enables access to the API when RE Manager environment is locked.
If the parameter is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the key overrides the current lock key set by
<code class="docutils literal notranslate"><span class="pre">REManagerAPI.lock_key</span></code>. See documentation on <code class="docutils literal notranslate"><span class="pre">REMangerAPI.lock()</span></code> for
more information. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>response: dict</dt><dd><p>Dictionary keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">success</span></code>: <em>boolean</em> - success of the request.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">msg</span></code>: <em>str</em> - error message in case the request is rejected by RE Manager
or operation failed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">task_uid</span></code> - UID of the started task.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>RequestTimeoutError, RequestFailedError, HTTPRequestError, HTTPClientError, HTTPServerError</dt><dd><p>All exceptions raised by <code class="docutils literal notranslate"><span class="pre">send_request</span></code> API.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">script</span> <span class="o">=</span> <span class="s2">&quot;def test_sleep():</span><span class="se">\n</span><span class="s2">    yield from bps.sleep(5)</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="c1"># Synchronous code (0MQ, HTTP)</span>
<span class="n">RM</span><span class="o">.</span><span class="n">script_upload</span><span class="p">(</span><span class="n">script</span><span class="p">)</span>

<span class="c1"># Asynchronous code (0MQ, HTTP)</span>
<span class="k">await</span> <span class="n">RM</span><span class="o">.</span><span class="n">script_upload</span><span class="p">(</span><span class="n">script</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="bluesky_queueserver_api.zmq.REManagerAPI.default_lock_key_path.html" class="btn btn-neutral float-left" title="bluesky_queueserver_api.zmq.REManagerAPI.default_lock_key_path" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="bluesky_queueserver_api.zmq.REManagerAPI.function_execute.html" class="btn btn-neutral float-right" title="bluesky_queueserver_api.zmq.REManagerAPI.function_execute" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Brookhaven National Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>